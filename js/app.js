"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var scrollCorrection=70;function scrolltoElement(e,t){var n=new Event("scroll"),e=(n.stopPropagation(),setTimeout(function(){window.dispatchEvent(n)},320),t=t||scrollCorrection,e.href?$(decodeURI(e.getAttribute("href"))):$(e));$("html, body").animate({scrollTop:e.offset().top-t},300)}function setHeader(){var n,e,t,r,o,a,i;window.subData&&(n=$("header .wrapper"),e=$(".s-comment",n),t=$(".s-toc",n),r=window.subData.title,n.find(".nav-sub .logo").text(r),o=document.body.scrollTop,$(document,window).scroll(function(){var e=$(window).scrollTop(),t=e-o;50<=t&&100<e?(o=e,window.subData&&n.addClass("sub")):t<=-50&&(o=e,n.removeClass("sub"))}),(a=$("#comments")).length?e.click(function(e){e.preventDefault(),e.stopPropagation(),scrolltoElement(a)}):e.remove(),(i=$(".toc-wrapper")).length&&i.children().length?t.click(function(e){e.stopPropagation(),i.toggleClass("active")}):t.remove())}function setHeaderMenu(){var e=$(".l_header .menu");e.find("li a.active").removeClass("active");var t=location.pathname.replace(/\/|%/g,""),n=(t=0==t.length?"home":t).match(/page\d{0,}$/g),n=(t=n&&t.split(n)[0]?t.split(n)[0]:t).match(/index.html/);n&&(n=n[0],t=t.split(n)[0]),n=$("#"+t,e),(t=n)&&t.length&&t.addClass("active").siblings().removeClass("active")}function setHeaderMenuPhone(){var t=$(".l_header .switcher .s-menu");t.unbind("click"),t.click(function(e){e.stopPropagation(),$("body").toggleClass("z_menu-open"),t.toggleClass("active")}),$(document).click(function(e){$("body").removeClass("z_menu-open"),t.removeClass("active")})}function setHeaderSearch(){var e=$(".l_header .switcher .s-search"),t=$(".l_header"),n=$(".l_header .m_search");0!==e.length&&(e.unbind("click"),e.click(function(e){e.stopPropagation(),t.toggleClass("z_search-open"),n.find("input").focus()}),$(document).click(function(e){t.removeClass("z_search-open")}),n.unbind("click"),n.click(function(e){e.stopPropagation()}),n.keydown(function(e){9==e.keyCode&&e.preventDefault()}))}function setTocToggle(){var r,e,t,a=document.querySelectorAll(".toc-link");function i(e){e.classList.contains("active")||(document.querySelectorAll(".toc .active").forEach(function(e){e.classList.remove("active")}),e.classList.add("active"))}function n(){for(var e=_toConsumableArray(a).map(function(e){return Math.floor($(decodeURI(e.getAttribute("original"))).offset().top-scrollCorrection)}),t=$("html").scrollTop()||$("body").scrollTop(),n=0,r=e.length-1;n<r;){var o=n+r+1>>1;e[o]===t?n=r=o:e[o]<t?n=o:r=o-1}i(a[n])}a.length&&(r=_toConsumableArray(a).map(function(e){var t=document.getElementById(decodeURI(e.getAttribute("href")).replace("#",""));return e.setAttribute("onclick","return false;"),e.setAttribute("original",e.getAttribute("href")),e.setAttribute("href","/"),e.addEventListener("click",function(e){e.preventDefault(),scrolltoElement(t),history.pushState(null,document.title,"#"+t.id)}),t}),e=window.innerHeight,e={rootMargin:"".concat(-scrollCorrection,"px 0px ").concat(2*scrollCorrection-e,"px 0px")},t=new IntersectionObserver(function(e){e=function(e){for(var t=-1,n=0;n<e.length;n++)e[n].isIntersecting&&(t=r.indexOf(e[n].target));return t}(e);-1!=e&&i(a[e])},e),r.forEach(function(e){t.observe(e)}),$(window).resize(n),n())}function secondToDate(e){var t;return e?(t=new Array(0,0,0,0),86400<=e&&(t[0]=parseInt(e/86400),e%=86400),3600<=e&&(t[1]=parseInt(e/3600),e%=3600),60<=e&&(t[2]=parseInt(e/60),e%=60),0<e&&(t[3]=e),t):0}function setTime(){var e=Math.round(new Date(Date.UTC(2018,3,21,6,6,6)).getTime()/1e3),e=secondToDate(Math.round(((new Date).getTime()+288e5)/1e3)-e),e=" ".concat(e[0]," 天 ").concat(e[1]," 时 ").concat(e[2]," 分 ").concat(e[3]," 秒");document.getElementById("htmer_time").innerHTML=e}function registerCopyCode(){document.querySelectorAll("figure.highlight").forEach(function(e){function t(e){e.innerHTML='<i class="fa fa-clipboard"></i>'}var n=document.createElement("div"),n=(n.classList.add("highlight-wrap"),$(e).wrap(n),e.parentNode.insertAdjacentHTML("beforeend",'<div class="copy-btn"></div>'),e.parentNode.querySelector(".copy-btn"));n.addEventListener("click",function(e){var t=e.currentTarget,e=_toConsumableArray(t.parentNode.querySelectorAll(".code .line")).map(function(e){return e.innerText}).join("\n");navigator.clipboard.writeText(e).then(function(){t.innerText="复制成功"},function(){t.innerText="复制失败"}),t.blur()}),n.addEventListener("mouseleave",function(e){setTimeout(function(){t(e.target)},300)}),t(n)})}function reset(){setHeader(),setHeaderMenu(),setHeaderMenuPhone(),setHeaderSearch(),setTocToggle(),registerCopyCode(),renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]}),$(".article-entry").find("img").fancybox(),fetch("https://v1.hitokoto.cn/?c=a").then(function(e){return e.json()}).then(function(e){var t=document.getElementById("hitokoto-content"),n=document.getElementById("hitokoto-from");t.innerText=e.hitokoto,n.innerText="——"+e.from}).catch(function(e){console.error(e)})}setInterval(setTime,1e3);